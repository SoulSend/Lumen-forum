var rs=Object.defineProperty,ds=Object.defineProperties;var cs=Object.getOwnPropertyDescriptors;var He=Object.getOwnPropertySymbols;var us=Object.prototype.hasOwnProperty,vs=Object.prototype.propertyIsEnumerable;var Re=(c,p,_)=>p in c?rs(c,p,{enumerable:!0,configurable:!0,writable:!0,value:_}):c[p]=_,Pe=(c,p)=>{for(var _ in p||(p={}))us.call(p,_)&&Re(c,_,p[_]);if(He)for(var _ of He(p))vs.call(p,_)&&Re(c,_,p[_]);return c},ze=(c,p)=>ds(c,cs(p));var R=(c,p,_)=>new Promise((w,C)=>{var $=h=>{try{m(_.next(h))}catch(U){C(U)}},I=h=>{try{m(_.throw(h))}catch(U){C(U)}},m=h=>h.done?w(h.value):Promise.resolve(h.value).then($,I);m((_=_.apply(c,p)).next())});import{r as b,c as M,h as we,S as Ye,x as $e,H as te,ag as N,I as l,z as t,A as e,Q as i,D as se,M as r,y as a,a4 as fe,u as Y,O as v,C as ge,T as ms,P as V,K as H,a6 as B,V as ae,aB as ps,aw as _s,aC as Fe,aA as fs,B as gs}from"./vue-vendor-D9-fr2Es.js";import{u as hs,v as Oe,w as bs,a as j,o as Be,x as ys}from"./ui-vendor-BbrJz_TA.js";import{u as Ie,e as ce,f as Ve,E as Ge,d as ks,p as Ne,T as ws,D as Ke,g as We}from"./index-D15Qezav.js";const $s="data:image/png;base64,//4vAC8AIABUAGgAaQBzACAAaQBzACAAYQAgAHAAbABhAGMAZQBoAG8AbABkAGUAcgAgAGYAbwByACAAdABoAGUAIABkAGUAZgBhAHUAbAB0ACAAYQB2AGEAdABhAHIADQAKAA==",W={xs:480,sm:768,md:992,lg:1200,xl:1920},Ze=()=>{const c=b(0),p=b(0),_=()=>{c.value=window.innerWidth,p.value=window.innerHeight},w=M(()=>{const L=c.value;return L<W.xs?"xs":L<W.sm?"sm":L<W.md?"md":L<W.lg?"lg":"xl"}),C=M(()=>c.value<W.xs),$=M(()=>c.value>=W.xs&&c.value<W.sm),I=M(()=>c.value>=W.sm&&c.value<W.md),m=M(()=>c.value>=W.md&&c.value<W.lg),h=M(()=>c.value>=W.lg),U=M(()=>c.value<W.md),y=M(()=>c.value>=W.md&&c.value<W.lg),D=M(()=>c.value>=W.lg),G=M(()=>c.value>p.value),P=M(()=>c.value<=p.value),Z=L=>M(()=>c.value>=W[L]),le=L=>M(()=>c.value<W[L]),ne=(L,O)=>M(()=>c.value>=W[L]&&c.value<W[O]);return we(()=>{_(),window.addEventListener("resize",_)}),Ye(()=>{window.removeEventListener("resize",_)}),{windowWidth:M(()=>c.value),windowHeight:M(()=>p.value),currentBreakpoint:w,isXs:C,isSm:$,isMd:I,isLg:m,isXl:h,isMobile:U,isTablet:y,isDesktop:D,isLandscape:G,isPortrait:P,isGte:Z,isLt:le,isBetween:ne}},Cs=()=>{const{isMobile:c,isTablet:p}=Ze();return{getPadding:(C,$,I)=>M(()=>c.value?C:p.value?$:I),getMargin:(C,$,I)=>M(()=>c.value?C:p.value?$:I)}},Ss={class:"login-container"},As={class:"login-form"},Ts={class:"login-tabs"},xs={class:"form-content",key:"phone"},Ms={class:"verification-code"},Is={key:0,class:"countdown-wrapper"},Us={class:"countdown-number"},Ls={class:"countdown-circle",viewBox:"0 0 40 40"},Es={key:1},Ds={class:"form-content",key:"email"},Ps={class:"verification-code"},zs={key:0,class:"countdown-wrapper"},Fs={class:"countdown-number"},Vs={class:"countdown-circle",viewBox:"0 0 40 40"},Ns={key:1},Hs=$e({__name:"LoginModal",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","login-success"],setup(c,{emit:p}){const _=Ie(),w=c,C=p,$=b("phone"),I=b(!1),m=b(!1),h=b(0),U=b(!1),y=b(),D=b(),G=b({phone:"",code:""}),P=b({email:"",code:""}),Z={phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的11位手机号",trigger:"blur"},{validator:(T,o,k)=>{o&&!/^1[3-9]\d{9}$/.test(o)&&o!=="123"?k(new Error("手机号格式不正确")):k()},trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{pattern:/^\d{6}$/,message:"验证码必须为6位数字",trigger:"blur"},{validator:(T,o,k)=>{o&&!/^\d{6}$/.test(o)&&o!=="123456"?k(new Error("验证码必须为6位数字")):k()},trigger:"blur"}]},le={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"请输入正确的邮箱地址",trigger:"blur"},{validator:(T,o,k)=>{o==="test@example.com"?k():o&&!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o)?k(new Error("邮箱格式不正确")):k()},trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{pattern:/^\d{6}$/,message:"验证码必须为6位数字",trigger:"blur"},{validator:(T,o,k)=>{P.value.email==="test@example.com"&&o==="123456"?k():o&&!/^\d{6}$/.test(o)?k(new Error("验证码必须为6位数字")):k()},trigger:"blur"}]};M(()=>h.value>0?`${h.value}秒后重新获取`:"获取验证码");const ne=M(()=>{const T=2*Math.PI*18,o=h.value/(ce.MINUTE/1e3)*T;return T-o}),L=M({get:()=>w.visible,set:T=>C("update:visible",T)}),O=()=>{C("update:visible",!1)},X=T=>{$.value!==T&&($.value=T)},E=T=>R(null,null,function*(){try{let o=!1;if(T==="phone"?(yield y.value.validateField("phone"),o=yield _.sendVerificationCode("SMS",G.value.phone)):(yield D.value.validateField("email"),o=yield _.sendVerificationCode("EMAIL",P.value.email)),o){m.value=!0,h.value=ce.MINUTE/1e3;const k=setInterval(()=>{h.value--,h.value<=0&&(clearInterval(k),m.value=!1)},1e3);j({message:"验证码已发送，请查收",type:"success",duration:2e3})}else j({message:_.error||"发送验证码失败，请稍后重试",type:"error",duration:3e3})}catch(o){}}),f=()=>R(null,null,function*(){try{yield y.value.validate(),I.value=!0;try{if(G.value.phone==="123"&&G.value.code==="123456")setTimeout(()=>{I.value=!1;const T={id:123,username:"测试用户",avatar:"/default-avatar/1.png",email:"test@example.com",phone:"123",bio:"这是一个测试账号，用于演示登录功能",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),reputation:100,post_count:5,comment_count:10,is_admin:!1,is_moderator:!1,last_active_at:new Date().toISOString(),token:"test-token-123"};_.login(T),j({message:"测试用户登录成功",type:"success",duration:2e3}),C("login-success"),O()},1e3);else{const T=yield _.loginWithPhone(G.value.phone,G.value.code,G.value.rememberMe);I.value=!1,T?(j({message:"登录成功！",type:"success",duration:2e3}),C("login-success"),O()):j({message:_.error||"登录失败，请检查手机号和验证码",type:"error",duration:3e3})}}catch(T){I.value=!1,j.error("登录失败，请检查手机号和验证码是否正确")}}catch(T){}}),g=()=>R(null,null,function*(){try{yield D.value.validate(),I.value=!0;try{if(P.value.email==="test@example.com")setTimeout(()=>{I.value=!1;const T={id:123,username:"测试用户",avatar:"/default-avatar/1.png",email:"test@example.com",phone:"",bio:"这是一个测试账号，用于演示登录功能",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),reputation:100,post_count:5,comment_count:10,is_admin:!1,is_moderator:!1,last_active_at:new Date().toISOString(),token:"test-token-123"};_.login(T),j({message:"测试用户登录成功",type:"success",duration:2e3}),C("login-success"),O()},1e3);else{const T=yield _.loginWithEmail(P.value.email,P.value.code,P.value.rememberMe);I.value=!1,T?(j({message:"登录成功！",type:"success",duration:2e3}),C("login-success"),O()):j({message:_.error||"登录失败，请检查邮箱和验证码",type:"error",duration:3e3})}}catch(T){I.value=!1,j.error("登录失败，请检查邮箱和验证码是否正确")}}catch(T){}}),A=()=>{U.value=!0},S=()=>{U.value=!1};return(T,o)=>{const k=N("el-input"),q=N("el-form-item"),ee=N("el-button"),me=N("el-form"),ue=N("el-dialog");return t(),te(ue,{modelValue:L.value,"onUpdate:modelValue":o[8]||(o[8]=Q=>L.value=Q),"show-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!0,"custom-class":"login-modal",width:"800px","append-to-body":!0,"destroy-on-close":!0,"before-close":O,"lock-scroll":!0,"modal-class":"login-modal-overlay"},{default:l(()=>[e("div",Ss,[o[14]||(o[14]=e("div",{class:"login-info"},[e("div",{class:"brand"},[e("h2",{class:"brand-name"},"Lumen论坛"),e("p",{class:"brand-slogan"},"分享知识，连接世界")]),e("div",{class:"info-content"},[e("p",null,"欢迎加入我们的社区！"),e("p",null,"在这里，您可以发现精彩内容，结交志同道合的朋友。")]),e("div",{class:"decoration"},[e("div",{class:"circle circle-1"}),e("div",{class:"circle circle-2"}),e("div",{class:"circle circle-3"}),e("div",{class:"floating-dots"})])],-1)),e("div",As,[o[13]||(o[13]=e("h3",{class:"form-title"},"账号登录",-1)),e("div",Ts,[e("div",{class:se(["tab-item",{active:$.value==="phone"}]),onClick:o[0]||(o[0]=Q=>X("phone"))},o[9]||(o[9]=[e("i",{class:"tab-icon phone-icon"},null,-1),r(" 手机号登录 ")]),2),e("div",{class:se(["tab-item",{active:$.value==="email"}]),onClick:o[1]||(o[1]=Q=>X("email"))},o[10]||(o[10]=[e("i",{class:"tab-icon email-icon"},null,-1),r(" 邮箱登录 ")]),2)]),i(ms,{name:"fade",mode:"out-in"},{default:l(()=>[$.value==="phone"?(t(),a("div",xs,[i(me,{model:G.value,ref_key:"phoneFormRef",ref:y,rules:Z},{default:l(()=>[i(q,{prop:"phone"},{default:l(()=>[i(k,{modelValue:G.value.phone,"onUpdate:modelValue":o[2]||(o[2]=Q=>G.value.phone=Q),placeholder:"请输入手机号","prefix-icon":Y(hs),clearable:"",onKeyup:fe(f,["enter"]),onCompositionstart:A,onCompositionend:S},null,8,["modelValue","prefix-icon"])]),_:1}),i(q,{prop:"code"},{default:l(()=>[e("div",Ms,[i(k,{modelValue:G.value.code,"onUpdate:modelValue":o[3]||(o[3]=Q=>G.value.code=Q),placeholder:"请输入验证码","prefix-icon":Y(Oe),clearable:"",onKeyup:fe(f,["enter"]),onCompositionstart:A,onCompositionend:S},null,8,["modelValue","prefix-icon"]),i(ee,{type:"primary",disabled:m.value,onClick:o[4]||(o[4]=Q=>E("phone")),class:se(["code-button",{"is-getting":m.value}])},{default:l(()=>[m.value?(t(),a("span",Is,[e("span",Us,v(h.value),1),(t(),a("svg",Ls,[e("circle",{cx:"20",cy:"20",r:"18","stroke-width":"2",fill:"none","stroke-linecap":"round",style:ge({"stroke-dashoffset":ne.value})},null,4)]))])):(t(),a("span",Es,"获取验证码"))]),_:1},8,["disabled","class"])])]),_:1}),i(q,null,{default:l(()=>[i(ee,{type:"primary",class:"submit-btn",loading:I.value,onClick:f},{default:l(()=>o[11]||(o[11]=[r(" 登录 ")])),_:1,__:[11]},8,["loading"])]),_:1})]),_:1},8,["model"])])):(t(),a("div",Ds,[i(me,{model:P.value,ref_key:"emailFormRef",ref:D,rules:le},{default:l(()=>[i(q,{prop:"email"},{default:l(()=>[i(k,{modelValue:P.value.email,"onUpdate:modelValue":o[5]||(o[5]=Q=>P.value.email=Q),placeholder:"请输入邮箱","prefix-icon":Y(bs),clearable:"",onKeyup:fe(g,["enter"]),onCompositionstart:A,onCompositionend:S},null,8,["modelValue","prefix-icon"])]),_:1}),i(q,{prop:"code"},{default:l(()=>[e("div",Ps,[i(k,{modelValue:P.value.code,"onUpdate:modelValue":o[6]||(o[6]=Q=>P.value.code=Q),placeholder:"请输入验证码","prefix-icon":Y(Oe),clearable:"",onKeyup:fe(g,["enter"]),onCompositionstart:A,onCompositionend:S},null,8,["modelValue","prefix-icon"]),i(ee,{type:"primary",disabled:m.value,onClick:o[7]||(o[7]=Q=>E("email")),class:se(["code-button",{"is-getting":m.value}])},{default:l(()=>[m.value?(t(),a("span",zs,[e("span",Fs,v(h.value),1),(t(),a("svg",Vs,[e("circle",{cx:"20",cy:"20",r:"18","stroke-width":"2",fill:"none","stroke-linecap":"round",style:ge({"stroke-dashoffset":ne.value})},null,4)]))])):(t(),a("span",Ns,"获取验证码"))]),_:1},8,["disabled","class"])])]),_:1}),i(q,null,{default:l(()=>[i(ee,{type:"primary",class:"submit-btn",loading:I.value,onClick:g},{default:l(()=>o[12]||(o[12]=[r(" 登录 ")])),_:1,__:[12]},8,["loading"])]),_:1})]),_:1},8,["model"])]))]),_:1})])])]),_:1},8,["modelValue"])}}}),Ce=(c,p)=>{const _=c.__vccOpts||c;for(const[w,C]of p)_[w]=C;return _},Rs=Ce(Hs,[["__scopeId","data-v-2f35e93c"]]);function ye(c){return c&&c.trim()?c:$s}const Os={class:"app-header"},Bs={class:"container"},Gs={class:"header-content"},Ks={class:"logo-container"},Ws={class:"main-nav"},Ys={class:"nav-list"},Zs={class:"nav-item"},qs={class:"nav-item"},Qs={class:"nav-item"},js={class:"search-container"},Xs={class:"search-suggestions"},Js={key:0,class:"suggestion-section"},et={class:"suggestion-list"},st=["onClick"],tt=["innerHTML"],ot={key:1,class:"suggestion-section"},at={class:"section-title"},nt={class:"suggestion-list"},lt=["onClick"],it={key:2,class:"suggestion-section"},rt={class:"hot-tags"},dt={class:"user-actions"},ct={class:"user-profile"},ut=["src"],vt={class:"user-name hide-on-mobile"},mt={class:"mobile-nav-container"},pt={class:"mobile-search"},_t={key:0,class:"mobile-search-suggestions"},ft={key:0,class:"mobile-suggestion-section"},gt={class:"mobile-suggestion-list"},ht=["onClick"],bt=["innerHTML"],yt={class:"mobile-nav-list"},kt={class:"mobile-nav-item"},wt={class:"mobile-nav-item"},$t={class:"mobile-nav-item"},Ct={class:"mobile-nav-item"},St={class:"mobile-nav-item"},At={class:"mobile-nav-item"},Tt={class:"mobile-nav-item"},xt={key:1,class:"mobile-nav-item"},Mt=$e({__name:"Header",setup(c){const p=Ie(),_=M(()=>p.isAuthenticated),w=M(()=>p.currentUser);M(()=>p.isAdmin);const C=b(5),$=b(""),I=b(!1),m=b([]),h=b([]),U=b(null),y=b(["前端开发","美食推荐","户外探险","职场经验","装修攻略","养生健康","旅游景点","学习方法"]),D=b(!1),G=b(!1);b(!1),b(!1),b(!1);const P=b(!1),Z=ps();b([{id:1,name:"生活技巧",post_count:256,description:"日常生活中的各种实用技巧和窍门"},{id:2,name:"家居装饰",post_count:185,description:"家居装饰、布置和DIY创意"},{id:3,name:"美食烹饪",post_count:324,description:"美食菜谱、烹饪技巧和餐饮体验"},{id:4,name:"旅行探索",post_count:217,description:"旅行攻略、目的地推荐和旅途体验"},{id:5,name:"健康养生",post_count:198,description:"健康生活方式、运动健身和养生知识"},{id:6,name:"职场技能",post_count:176,description:"职场发展、技能提升和工作经验分享"}]);const le=x=>{const n=document.querySelector(".nav-dropdown-toggle");n&&!n.contains(x.target)&&(G.value=!1,document.removeEventListener("click",le))},ne=()=>{D.value=!D.value,D.value?document.body.style.overflow="hidden":document.body.style.overflow=""},L=()=>{D.value=!1,document.body.style.overflow=""},O=()=>{$.value.trim()&&(me($.value),Z.push({name:"search",query:{q:$.value}}),I.value=!1)},X=()=>{O(),L()},E=()=>{I.value=!0,Q()},f=()=>{setTimeout(()=>{I.value=!1},200)},g=()=>{U.value&&clearTimeout(U.value),U.value=setTimeout(()=>{$.value.trim().length>0?A():m.value=[]},300)},A=()=>R(null,null,function*(){try{const x=$.value.toLowerCase(),n=[x+" 相关文章","关于"+x+"的讨论",x+" 使用技巧",x+" 推荐",x+" 最佳实践"];m.value=n}catch(x){console.error("Failed to fetch search suggestions:",x),m.value=[]}}),S=x=>{if(!$.value.trim())return x;const n=new RegExp(`(${$.value})`,"gi");return x.replace(n,'<span class="highlight">$1</span>')},T=x=>{$.value=x,O()},o=x=>{$.value=x,O()},k=x=>{$.value=x,O()},q=x=>{h.value.splice(x,1),ue()},ee=()=>{h.value=[],ue()},me=x=>{if(!x.trim())return;const n=h.value.indexOf(x);n!==-1&&h.value.splice(n,1),h.value.unshift(x),h.value.length>10&&h.value.pop(),ue()},ue=()=>{try{localStorage.setItem("searchHistory",JSON.stringify(h.value))}catch(x){console.error("Failed to save search history to localStorage:",x)}},Q=()=>{try{const x=localStorage.getItem("searchHistory");x&&(h.value=JSON.parse(x))}catch(x){console.error("Failed to load search history from localStorage:",x),h.value=[]}},Se=()=>{P.value=!0},Ue=()=>R(null,null,function*(){}),pe=()=>R(null,null,function*(){try{yield p.logout(),j({message:"您已成功退出登录",type:"success",duration:2e3}),L(),Z.push("/")}catch(x){console.error("退出登录失败:",x),j({message:"退出登录失败，请稍后再试",type:"error",duration:3e3})}}),Le=()=>{Z.push({name:"createPost"})};return we(()=>R(null,null,function*(){Q()})),Ye(()=>{document.removeEventListener("click",le)}),(x,n)=>{var Me;const J=N("router-link"),de=N("el-button"),he=N("el-input"),Ae=N("el-tag"),Te=N("el-popover"),ie=N("el-dropdown-item"),be=N("el-badge"),xe=N("el-dropdown-menu"),Ee=N("el-dropdown");return t(),a(V,null,[e("header",Os,[e("div",Bs,[e("div",Gs,[e("div",Ks,[i(J,{to:"/",class:"logo"},{default:l(()=>n[8]||(n[8]=[e("span",{class:"logo-text font-rounded text-gradient"},"Lumen",-1)])),_:1,__:[8]})]),e("nav",Ws,[e("ul",Ys,[e("li",Zs,[i(J,{to:"/",class:"nav-link font-rounded"},{default:l(()=>n[9]||(n[9]=[r("首页")])),_:1,__:[9]})]),e("li",qs,[i(J,{to:"/search",class:"nav-link font-rounded"},{default:l(()=>n[10]||(n[10]=[r("热门")])),_:1,__:[10]})]),e("li",Qs,[i(J,{to:"/about",class:"nav-link font-rounded"},{default:l(()=>n[11]||(n[11]=[r("关于")])),_:1,__:[11]})])])]),e("div",js,[i(Te,{visible:I.value&&$.value.trim().length>0,placement:"bottom-start",width:320,trigger:"manual","popper-class":"search-popover",transition:"el-zoom-in-top"},{reference:l(()=>[e("form",{onSubmit:ae(O,["prevent"]),class:"search-form"},[i(he,{modelValue:$.value,"onUpdate:modelValue":n[0]||(n[0]=z=>$.value=z),placeholder:"搜索帖子、话题或用户...","prefix-icon":Y(Be),class:"search-input",onKeyup:fe(O,["enter"]),onFocus:E,onBlur:f,onInput:g,clearable:""},{append:l(()=>[i(de,{type:"primary",onClick:O},{default:l(()=>n[12]||(n[12]=[r(" 搜索 ")])),_:1,__:[12]})]),_:1},8,["modelValue","prefix-icon"])],32)]),default:l(()=>[e("div",Xs,[$.value&&m.value.length>0?(t(),a("div",Js,[n[14]||(n[14]=e("h4",{class:"section-title"},[e("i",{class:"icon-search"}),r("搜索建议 ")],-1)),e("div",et,[(t(!0),a(V,null,B(m.value,(z,oe)=>(t(),a("div",{key:`suggestion-${oe}`,class:"suggestion-item",onClick:_e=>T(z),onMousedown:n[1]||(n[1]=ae(()=>{},["prevent"]))},[n[13]||(n[13]=e("i",{class:"icon-search-item"},null,-1)),e("span",{innerHTML:S(z)},null,8,tt)],40,st))),128))])])):H("",!0),!$.value&&h.value.length>0?(t(),a("div",ot,[e("h4",at,[n[16]||(n[16]=e("i",{class:"icon-history"},null,-1)),n[17]||(n[17]=r("最近搜索 ")),i(de,{link:"",class:"clear-button",onClick:ae(ee,["stop"]),onMousedown:n[2]||(n[2]=ae(()=>{},["prevent"]))},{default:l(()=>n[15]||(n[15]=[r(" 清除 ")])),_:1,__:[15]})]),e("div",nt,[(t(!0),a(V,null,B(h.value.slice(0,5),(z,oe)=>(t(),a("div",{key:`history-${oe}`,class:"suggestion-item",onClick:_e=>o(z),onMousedown:n[4]||(n[4]=ae(()=>{},["prevent"]))},[n[19]||(n[19]=e("i",{class:"icon-history-item"},null,-1)),e("span",null,v(z),1),i(de,{link:"",class:"remove-button",onClick:ae(_e=>q(oe),["stop"]),onMousedown:n[3]||(n[3]=ae(()=>{},["prevent"]))},{default:l(()=>n[18]||(n[18]=[e("i",{class:"icon-close"},null,-1)])),_:2,__:[18]},1032,["onClick"])],40,lt))),128))])])):H("",!0),!$.value||m.value.length===0?(t(),a("div",it,[n[20]||(n[20]=e("h4",{class:"section-title"},[e("i",{class:"icon-fire"}),r("热门搜索 ")],-1)),e("div",rt,[(t(!0),a(V,null,B(y.value,(z,oe)=>(t(),te(Ae,{key:`tag-${oe}`,size:"small",onClick:_e=>k(z),onMousedown:n[5]||(n[5]=ae(()=>{},["prevent"]))},{default:l(()=>[r(v(z),1)]),_:2},1032,["onClick"]))),128))])])):H("",!0)])]),_:1},8,["visible"])]),e("button",{class:"mobile-menu-toggle",onClick:ne,"aria-label":"打开菜单"},[e("span",{class:se(["menu-icon",{active:D.value}])},null,2)]),e("div",dt,[_.value?(t(),a(V,{key:0},[i(Ee,{trigger:"click",class:"user-dropdown"},{dropdown:l(()=>[i(xe,null,{default:l(()=>[i(ie,null,{default:l(()=>{var z;return[i(J,{to:{name:"userProfile",params:{id:(z=w.value)==null?void 0:z.id}},class:"dropdown-link"},{default:l(()=>n[22]||(n[22]=[e("span",{class:"material-icons-round"},"person",-1),r("个人资料 ")])),_:1,__:[22]},8,["to"])]}),_:1}),i(ie,null,{default:l(()=>[i(J,{to:{name:"notifications"},class:"dropdown-link"},{default:l(()=>[n[23]||(n[23]=e("span",{class:"material-icons-round"},"notifications",-1)),n[24]||(n[24]=r("通知 ")),C.value>0?(t(),te(be,{key:0,value:C.value,class:"notifications-badge"},null,8,["value"])):H("",!0)]),_:1,__:[23,24]})]),_:1}),i(ie,null,{default:l(()=>[i(J,{to:{name:"settings"},class:"dropdown-link"},{default:l(()=>n[25]||(n[25]=[e("span",{class:"material-icons-round"},"settings",-1),r("设置 ")])),_:1,__:[25]})]),_:1}),i(ie,{divided:""},{default:l(()=>[e("a",{href:"#",onClick:ae(pe,["prevent"]),class:"dropdown-link"},n[26]||(n[26]=[e("span",{class:"material-icons-round"},"logout",-1),r("退出登录 ")]))]),_:1})]),_:1})]),default:l(()=>{var z,oe;return[e("div",ct,[e("img",{src:Y(ye)((z=w.value)==null?void 0:z.avatar),alt:"用户头像",class:"avatar avatar--small"},null,8,ut),e("span",vt,v((oe=w.value)==null?void 0:oe.username),1),n[21]||(n[21]=e("span",{class:"material-icons-round dropdown-icon"},"expand_more",-1))])]}),_:1}),i(de,{type:"primary",class:"create-post-btn",onClick:Le},{default:l(()=>n[27]||(n[27]=[e("span",{class:"material-icons-round hide-on-mobile"},"add",-1),e("span",null,"发布帖子",-1)])),_:1,__:[27]})],64)):(t(),te(de,{key:1,type:"primary",class:"login-btn",onClick:Se},{default:l(()=>n[28]||(n[28]=[r(" 登录 ")])),_:1,__:[28]}))])])]),e("div",{class:se(["mobile-nav",{active:D.value}])},[e("div",mt,[e("div",{class:"mobile-nav-header"},[n[30]||(n[30]=e("span",{class:"logo-text"},"Lumen",-1)),e("button",{class:"close-menu-btn",onClick:ne},n[29]||(n[29]=[e("i",{class:"icon-close"},null,-1)]))]),e("div",pt,[i(he,{modelValue:$.value,"onUpdate:modelValue":n[6]||(n[6]=z=>$.value=z),placeholder:"搜索帖子、话题或用户...","prefix-icon":Y(Be),onKeyup:fe(X,["enter"]),onFocus:E,onBlur:f,onInput:g,clearable:""},{append:l(()=>[i(de,{type:"primary",onClick:X},{default:l(()=>n[31]||(n[31]=[r(" 搜索 ")])),_:1,__:[31]})]),_:1},8,["modelValue","prefix-icon"]),I.value&&$.value.trim().length>0?(t(),a("div",_t,[m.value.length>0?(t(),a("div",ft,[n[33]||(n[33]=e("h4",{class:"mobile-section-title"},[e("i",{class:"icon-search"}),r("搜索建议 ")],-1)),e("div",gt,[(t(!0),a(V,null,B(m.value,(z,oe)=>(t(),a("div",{key:`mobile-suggestion-${oe}`,class:"mobile-suggestion-item",onClick:_e=>T(z)},[n[32]||(n[32]=e("i",{class:"icon-search-item"},null,-1)),e("span",{innerHTML:S(z)},null,8,bt)],8,ht))),128))])])):H("",!0)])):H("",!0)]),e("ul",yt,[e("li",kt,[i(J,{to:"/",class:"mobile-nav-link",onClick:L},{default:l(()=>n[34]||(n[34]=[r("首页")])),_:1,__:[34]})]),e("li",wt,[i(J,{to:"/search",class:"mobile-nav-link",onClick:L},{default:l(()=>n[35]||(n[35]=[r("热门")])),_:1,__:[35]})]),e("li",$t,[i(J,{to:"/about",class:"mobile-nav-link",onClick:L},{default:l(()=>n[36]||(n[36]=[r("关于")])),_:1,__:[36]})]),_.value?(t(),a(V,{key:0},[e("li",Ct,[i(J,{to:"/notifications",class:"mobile-nav-link",onClick:L},{default:l(()=>[n[37]||(n[37]=r(" 通知 ")),C.value>0?(t(),te(be,{key:0,value:C.value,class:"notifications-badge"},null,8,["value"])):H("",!0)]),_:1,__:[37]})]),e("li",St,[i(J,{to:{name:"userProfile",params:{id:(Me=w.value)==null?void 0:Me.id}},class:"mobile-nav-link",onClick:L},{default:l(()=>n[38]||(n[38]=[r("个人资料")])),_:1,__:[38]},8,["to"])]),e("li",At,[i(J,{to:"/settings",class:"mobile-nav-link",onClick:L},{default:l(()=>n[39]||(n[39]=[r("设置")])),_:1,__:[39]})]),e("li",Tt,[e("a",{href:"#",class:"mobile-nav-link",onClick:ae(pe,["prevent"])},"退出登录")])],64)):(t(),a("li",xt,[e("a",{href:"#",class:"mobile-nav-link",onClick:ae(Se,["prevent"])},"登录")]))])])],2)]),i(Rs,{visible:P.value,"onUpdate:visible":n[7]||(n[7]=z=>P.value=z),onLoginSuccess:Ue},null,8,["visible"])],64)}}}),It=Ce(Mt,[["__scopeId","data-v-2410d877"]]),qe=_s("category",()=>{const c=b([]),p=b(!1),_=b(null),w=m=>{var h,U;return{id:m.id,name:m.name,description:m.description,icon:m.icon,parent:m.parent,postCount:(h=m.postCount)!=null?h:0,displayOrder:(U=m.displayOrder)!=null?U:0,deleted:m.deleted,createdAt:m.createdAt,updatedAt:m.updatedAt,children:m.children||[],slug:m.slug,created_at:m.created_at||m.createdAt,updated_at:m.updated_at||m.updatedAt,post_count:m.post_count||m.postCount,parent_id:m.parent_id||(m.parent?m.parent.id:null)}};function C(){return R(this,null,function*(){p.value=!0,_.value=null;try{const m=yield Ve.getCategories();return c.value=(m||[]).map(w),c.value}catch(m){const h=Ge.handleApiError(m);return _.value=ks.FETCH_CATEGORIES_FAILED,Ge.showError(h),null}finally{p.value=!1}})}function $(m){return R(this,null,function*(){p.value=!0,_.value=null;try{const h=yield Ve.getCategoryById(m);return w(h)}catch(h){return _.value=(h==null?void 0:h.message)||"获取分类详情失败",null}finally{p.value=!1}})}function I(U){return R(this,arguments,function*(m,h={}){p.value=!0,_.value=null;try{return yield Ne.getCategoryPosts(m,h.page||0,h.size||10)}catch(y){return _.value=(y==null?void 0:y.message)||"获取分类下的帖子失败",null}finally{p.value=!1}})}return{categories:c,loading:p,error:_,fetchCategories:C,fetchCategory:$,fetchCategoryPosts:I}}),Ut={class:"app-footer"},Lt={class:"container"},Et={class:"footer-grid"},Dt={class:"footer-section links-section"},Pt={class:"footer-links"},zt={class:"footer-section categories-section"},Ft={class:"footer-links"},Vt={class:"category-count"},Nt={class:"footer-section contact-section"},Ht={class:"newsletter"},Rt={class:"footer-bottom"},Ot={class:"copyright"},Bt={class:"bottom-links"},Gt=$e({__name:"Footer",setup(c){const p=qe(),_=b([]),w=b(""),C=b(!1),$=M(()=>new Date().getFullYear()),I=()=>R(null,null,function*(){if(!w.value||!m(w.value)){j.warning("请输入有效的邮箱地址");return}C.value=!0;try{yield new Promise(U=>setTimeout(U,800)),j.success("订阅成功！感谢您的关注"),w.value=""}catch(U){console.error("Failed to subscribe:",U),j.error("订阅失败，请稍后再试")}finally{C.value=!1}}),m=U=>/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/.test(U),h=()=>{window.scrollTo({top:0,behavior:"smooth"})};return we(()=>R(null,null,function*(){try{const U=yield p.fetchCategories();U&&(_.value=[...U].sort((y,D)=>(D.post_count||0)-(y.post_count||0)).slice(0,5))}catch(U){console.error("Failed to load popular categories:",U)}})),(U,y)=>{const D=N("router-link"),G=N("el-input"),P=N("el-button");return t(),a("footer",Ut,[e("div",Lt,[e("div",Et,[y[12]||(y[12]=Fe('<div class="footer-section brand-section" data-v-b89f9b7d><div class="footer-logo" data-v-b89f9b7d><span class="logo-text" data-v-b89f9b7d>Lumen</span></div><p class="footer-description" data-v-b89f9b7d>Lumen是一个现代生活技巧分享社区，帮助用户发现和分享提升生活质量的知识和经验。</p><div class="social-links" data-v-b89f9b7d><a href="#" class="social-link" aria-label="微信" data-v-b89f9b7d><i class="icon-wechat" data-v-b89f9b7d></i></a><a href="#" class="social-link" aria-label="微博" data-v-b89f9b7d><i class="icon-weibo" data-v-b89f9b7d></i></a><a href="#" class="social-link" aria-label="GitHub" data-v-b89f9b7d><i class="icon-github" data-v-b89f9b7d></i></a><a href="#" class="social-link" aria-label="知乎" data-v-b89f9b7d><i class="icon-zhihu" data-v-b89f9b7d></i></a></div></div>',1)),e("div",Dt,[y[7]||(y[7]=e("h3",{class:"footer-heading"},"快速链接",-1)),e("ul",Pt,[e("li",null,[i(D,{to:"/",class:"footer-link"},{default:l(()=>y[1]||(y[1]=[r("首页")])),_:1,__:[1]})]),e("li",null,[i(D,{to:"/search",class:"footer-link"},{default:l(()=>y[2]||(y[2]=[r("搜索")])),_:1,__:[2]})]),e("li",null,[i(D,{to:"/create-post",class:"footer-link"},{default:l(()=>y[3]||(y[3]=[r("发布帖子")])),_:1,__:[3]})]),e("li",null,[i(D,{to:"/about",class:"footer-link"},{default:l(()=>y[4]||(y[4]=[r("关于我们")])),_:1,__:[4]})]),e("li",null,[i(D,{to:"/terms",class:"footer-link"},{default:l(()=>y[5]||(y[5]=[r("使用条款")])),_:1,__:[5]})]),e("li",null,[i(D,{to:"/privacy",class:"footer-link"},{default:l(()=>y[6]||(y[6]=[r("隐私政策")])),_:1,__:[6]})])])]),e("div",zt,[y[8]||(y[8]=e("h3",{class:"footer-heading"},"热门分类",-1)),e("ul",Ft,[(t(!0),a(V,null,B(_.value,Z=>(t(),a("li",{key:Z.id},[i(D,{to:{name:"category",params:{id:Z.id}},class:"footer-link"},{default:l(()=>[r(v(Z.name)+" ",1),e("span",Vt,"("+v(Z.post_count)+")",1)]),_:2},1032,["to"])]))),128))])]),e("div",Nt,[y[11]||(y[11]=Fe('<h3 class="footer-heading" data-v-b89f9b7d>联系我们</h3><ul class="contact-info" data-v-b89f9b7d><li class="contact-item" data-v-b89f9b7d><span class="material-icons-round" data-v-b89f9b7d>email</span><span data-v-b89f9b7d>contact@lumen-forum.com</span></li><li class="contact-item" data-v-b89f9b7d><span class="material-icons-round" data-v-b89f9b7d>location_on</span><span data-v-b89f9b7d>北京市海淀区科技园区</span></li></ul>',2)),e("div",Ht,[y[10]||(y[10]=e("h4",{class:"newsletter-heading"},"订阅我们的周刊",-1)),e("form",{onSubmit:ae(I,["prevent"]),class:"newsletter-form"},[i(G,{modelValue:w.value,"onUpdate:modelValue":y[0]||(y[0]=Z=>w.value=Z),placeholder:"输入您的邮箱",class:"newsletter-input"},null,8,["modelValue"]),i(P,{type:"primary","native-type":"submit",loading:C.value,class:"newsletter-button"},{default:l(()=>y[9]||(y[9]=[r(" 订阅 ")])),_:1,__:[9]},8,["loading"])],32)])])]),e("div",Rt,[e("p",Ot," © "+v($.value)+" Lumen. 保留所有权利. ",1),e("div",Bt,[i(D,{to:"/sitemap",class:"bottom-link"},{default:l(()=>y[13]||(y[13]=[r("网站地图")])),_:1,__:[13]}),y[15]||(y[15]=e("span",{class:"divider"},"•",-1)),i(D,{to:"/faq",class:"bottom-link"},{default:l(()=>y[14]||(y[14]=[r("常见问题")])),_:1,__:[14]}),y[16]||(y[16]=e("span",{class:"divider"},"•",-1)),e("a",{href:"#",class:"bottom-link",onClick:ae(h,["prevent"])},"返回顶部")])])])])}}}),Kt=Ce(Gt,[["__scopeId","data-v-b89f9b7d"]]);function ml(c,p=ws.POST_EXCERPT_LENGTH,_="..."){return!c||typeof c!="string"?"":c.length<=p?c:c.substring(0,p)+_}function pl(c){if(c==null||isNaN(c))return"0";const p=Math.abs(c);return p<1e3?String(c):p<1e4?(c/1e3).toFixed(1)+"k":(c/1e4).toFixed(1)+"w"}function ke(c){if(!c)return"未知时间";try{const p=new Date(c);if(isNaN(p.getTime()))return"无效时间";const w=new Date().getTime()-p.getTime();return w<ce.MINUTE?"刚刚":w<ce.HOUR?`${Math.floor(w/ce.MINUTE)}分钟前`:w<ce.DAY?`${Math.floor(w/ce.HOUR)}小时前`:w<ce.WEEK?`${Math.floor(w/ce.DAY)}天前`:Qe(p)}catch(p){return console.warn("格式化相对时间失败:",c,p),"时间格式错误"}}function Qe(c){if(!c)return"未知日期";try{const p=typeof c=="string"?new Date(c):c;if(isNaN(p.getTime()))return"无效日期";const _=new Date,w=p.getFullYear(),C=String(p.getMonth()+1).padStart(2,"0"),$=String(p.getDate()).padStart(2,"0");return w===_.getFullYear()?`${C}-${$}`:`${w}-${C}-${$}`}catch(p){return console.warn("格式化日期失败:",c,p),"日期格式错误"}}const Wt={class:"comments-sidebar"},Yt={class:"sidebar-block"},Zt={class:"sidebar-header"},qt={key:0,class:"comments-loading"},Qt={key:1,class:"empty-comments"},jt={key:2,class:"comments-list"},Xt={class:"comment-header"},Jt=["src","alt"],eo={class:"user-name"},so={key:1,class:"user-link"},to=["src"],oo={class:"user-name"},ao={class:"comment-time"},no={class:"comment-content"},lo=["onClick"],io={class:"material-icons-round"},ro={class:"comment-footer"},co={class:"comment-actions"},uo={key:0,class:"solution-badge"},vo={class:"view-all-comments"},mo={class:"drawer-header"},po={class:"drawer-title"},_o={class:"drawer-content"},fo={key:0,class:"comments-loading"},go={key:1,class:"empty-comments"},ho={key:2,class:"drawer-comments-list"},bo={class:"comment-header"},yo=["src","alt"],ko={class:"user-name"},wo={key:1,class:"user-link"},$o=["src"],Co={class:"user-name"},So={class:"comment-time"},Ao={class:"comment-content drawer-comment-content"},To=["onClick"],xo={class:"material-icons-round"},Mo={class:"comment-footer"},Io={class:"comment-actions"},Uo={key:0,class:"comment-replies"},Lo={class:"reply-header"},Eo={class:"reply-username"},Do={key:1,class:"reply-username"},Po={class:"reply-time"},zo={class:"reply-content"},Fo={class:"reply-actions"},Vo={key:1,class:"solution-badge"},No={class:"drawer-footer"},Ho=$e({__name:"CommentList",props:{postId:{}},emits:["scrollToComments","scrollToCommentForm","replyToComment"],setup(c,{emit:p}){const _=p,w=b([]),C=b(!0),$=b(!1),I=b([]),m=b([]),h=b([]),U=Ie(),y=M(()=>{let E=3;const f=w.value.filter(g=>g.content.length<100);return f.length>3&&(E=Math.min(5,f.length)),[...w.value].sort((g,A)=>A.like_count-g.like_count).slice(0,E)}),D=()=>R(null,null,function*(){C.value=!0;try{w.value=[]}catch(E){console.error("Failed to fetch comments:",E)}finally{C.value=!1}}),G=()=>{$.value=!0},P=()=>{$.value=!1},Z=E=>{m.value.includes(E)?m.value=m.value.filter(f=>f!==E):m.value.push(E)},le=E=>{h.value.includes(E)?h.value=h.value.filter(f=>f!==E):h.value.push(E)},ne=E=>{I.value.includes(E)?I.value=I.value.filter(f=>f!==E):I.value.push(E)},L=E=>R(null,null,function*(){if(!U.isAuthenticated){j.warning("请登录后再进行点赞操作");return}try{const f=w.value.findIndex(S=>S.id===E);if(f===-1)return;const g=w.value[f],A=g.is_liked||g.isLiked||!1;w.value[f]=ze(Pe({},g),{is_liked:!A,isLiked:!A,like_count:A?(g.like_count||g.likeCount||0)-1:(g.like_count||g.likeCount||0)+1,likeCount:A?(g.like_count||g.likeCount||0)-1:(g.like_count||g.likeCount||0)+1}),j.success(A?"已取消点赞":"点赞成功")}catch(f){console.error("点赞操作失败:",f),j.error("操作失败，请稍后再试");const g=w.value.findIndex(A=>A.id===E);if(g!==-1){const A=w.value[g],S=A.is_liked||A.isLiked||!1;w.value[g]=ze(Pe({},A),{is_liked:!S,isLiked:!S,like_count:S?(A.like_count||A.likeCount||0)-1:(A.like_count||A.likeCount||0)+1,likeCount:S?(A.like_count||A.likeCount||0)-1:(A.like_count||A.likeCount||0)+1})}}}),O=(E,f)=>{var S;const g=w.value.find(T=>T.id===E);if(!g)return;const A=new CustomEvent("replyToComment",{detail:{commentId:E,username:((S=g.user)==null?void 0:S.username)||"未知用户"}});window.dispatchEvent(A),P(),X()},X=()=>{P(),_("scrollToCommentForm")};return we(()=>{D(),window.addEventListener("refreshComments",()=>{D()})}),(E,f)=>{const g=N("el-button"),A=N("el-tooltip"),S=N("el-skeleton"),T=N("router-link");return t(),a("div",Wt,[e("div",Yt,[e("div",Zt,[f[2]||(f[2]=e("h3",{class:"sidebar-title"},"热门评论",-1)),i(A,{content:"发表新评论",placement:"top","hide-after":0},{default:l(()=>[i(g,{type:"primary",size:"small",onClick:X},{default:l(()=>f[1]||(f[1]=[e("span",{class:"material-icons-round"},"edit",-1),r(" 发表评论 ")])),_:1,__:[1]})]),_:1})]),C.value?(t(),a("div",qt,[i(S,{rows:3,animated:""})])):y.value.length===0?(t(),a("div",Qt,[f[4]||(f[4]=e("p",{class:"empty-text"},"暂无评论",-1)),i(g,{size:"small",type:"primary",onClick:X},{default:l(()=>f[3]||(f[3]=[r(" 添加第一条评论 ")])),_:1,__:[3]})])):(t(),a("div",jt,[(t(!0),a(V,null,B(y.value,o=>(t(),a("div",{key:o.id,class:"comment-item"},[e("div",Xt,[o.user&&o.user.id?(t(),te(T,{key:0,to:{name:"userProfile",params:{id:o.user.id}},class:"user-link"},{default:l(()=>{var k,q;return[e("img",{src:Y(ye)((k=o.user)==null?void 0:k.avatar),alt:((q=o.user)==null?void 0:q.username)||"用户",class:"avatar avatar--small"},null,8,Jt),e("span",eo,v(o.user.username),1)]}),_:2},1032,["to"])):(t(),a("div",so,[e("img",{src:Y(ye)(),alt:"用户",class:"avatar avatar--small"},null,8,to),e("span",oo,v(Y(Ke).UNKNOWN_USER),1)])),e("span",ao,v(Y(ke)(o.created_at)),1)]),e("div",no,[e("div",{class:se(["comment-text",{expanded:m.value.includes(o.id)}]),style:ge(!m.value.includes(o.id)&&o.content&&o.content.length>100?"max-height: 80px;":"")},v(o.content),7),o.content&&o.content.length>100?(t(),a("div",{key:0,class:"expand-toggle",onClick:k=>Z(o.id)},[r(v(m.value.includes(o.id)?"收起":"展开")+" ",1),e("span",io,v(m.value.includes(o.id)?"keyboard_arrow_up":"keyboard_arrow_down"),1)],8,lo)):H("",!0)]),e("div",ro,[e("div",co,[i(A,{content:"点赞此评论",placement:"top","hide-after":0},{default:l(()=>[i(g,{size:"small",text:"",onClick:k=>L(o.id)},{default:l(()=>[f[5]||(f[5]=e("span",{class:"material-icons-round"},"thumb_up",-1)),r(" "+v(o.like_count),1)]),_:2,__:[5]},1032,["onClick"])]),_:2},1024),i(A,{content:"回复此评论",placement:"top","hide-after":0},{default:l(()=>[i(g,{size:"small",text:"",onClick:k=>O(o.id)},{default:l(()=>f[6]||(f[6]=[e("span",{class:"material-icons-round"},"reply",-1),r(" 回复 ")])),_:2,__:[6]},1032,["onClick"])]),_:2},1024)])]),o.is_solution?(t(),a("div",uo,f[7]||(f[7]=[e("span",{class:"material-icons-round"},"verified",-1),r(" 最佳回答 ")]))):H("",!0)]))),128))])),e("div",vo,[i(g,{type:"primary",plain:"",onClick:G},{default:l(()=>[r(" 查看全部评论 ("+v(w.value.length)+") ",1)]),_:1})])]),i(Y(ys),{modelValue:$.value,"onUpdate:modelValue":f[0]||(f[0]=o=>$.value=o),title:"评论列表",direction:"rtl",size:"50%","with-header":!0,"destroy-on-close":!1,"before-close":P},{header:l(()=>[e("div",mo,[e("h3",po,"评论列表 ("+v(w.value.length)+")",1),i(g,{type:"primary",size:"small",onClick:X},{default:l(()=>f[8]||(f[8]=[e("span",{class:"material-icons-round"},"edit",-1),r(" 发表评论 ")])),_:1,__:[8]})])]),footer:l(()=>[e("div",No,[i(g,{onClick:P},{default:l(()=>f[17]||(f[17]=[r("关闭")])),_:1,__:[17]}),i(g,{type:"primary",onClick:X},{default:l(()=>f[18]||(f[18]=[r("发表评论")])),_:1,__:[18]})])]),default:l(()=>[e("div",_o,[C.value?(t(),a("div",fo,[i(S,{rows:5,animated:""})])):w.value.length===0?(t(),a("div",go,[f[10]||(f[10]=e("p",{class:"empty-text"},"暂无评论",-1)),i(g,{size:"small",type:"primary",onClick:X},{default:l(()=>f[9]||(f[9]=[r(" 添加第一条评论 ")])),_:1,__:[9]})])):(t(),a("div",ho,[(t(!0),a(V,null,B(w.value,o=>(t(),a("div",{key:o.id,class:"comment-item"},[e("div",bo,[o.user&&o.user.id?(t(),te(T,{key:0,to:{name:"userProfile",params:{id:o.user.id}},class:"user-link"},{default:l(()=>{var k,q;return[e("img",{src:Y(ye)((k=o.user)==null?void 0:k.avatar),alt:((q=o.user)==null?void 0:q.username)||"用户",class:"avatar avatar--small"},null,8,yo),e("span",ko,v(o.user.username),1)]}),_:2},1032,["to"])):(t(),a("div",wo,[e("img",{src:Y(ye)(),alt:"用户",class:"avatar avatar--small"},null,8,$o),e("span",Co,v(Y(Ke).UNKNOWN_USER),1)])),e("span",So,v(Y(ke)(o.created_at)),1)]),e("div",Ao,[e("div",{class:se(["comment-text",{expanded:h.value.includes(o.id)}]),style:ge(!h.value.includes(o.id)&&o.content&&o.content.length>250?"max-height: 120px;":"")},v(o.content),7),o.content&&o.content.length>250?(t(),a("div",{key:0,class:"expand-toggle",onClick:k=>le(o.id)},[r(v(h.value.includes(o.id)?"收起":"展开")+" ",1),e("span",xo,v(h.value.includes(o.id)?"keyboard_arrow_up":"keyboard_arrow_down"),1)],8,To)):H("",!0)]),e("div",Mo,[e("div",Io,[i(A,{content:"点赞此评论",placement:"top","hide-after":0},{default:l(()=>[i(g,{size:"small",text:"",onClick:k=>L(o.id)},{default:l(()=>[f[11]||(f[11]=e("span",{class:"material-icons-round"},"thumb_up",-1)),r(" "+v(o.like_count),1)]),_:2,__:[11]},1032,["onClick"])]),_:2},1024),i(A,{content:"回复此评论",placement:"top","hide-after":0},{default:l(()=>[i(g,{size:"small",text:"",onClick:k=>O(o.id)},{default:l(()=>f[12]||(f[12]=[e("span",{class:"material-icons-round"},"reply",-1),r(" 回复 ")])),_:2,__:[12]},1032,["onClick"])]),_:2},1024),o.replies&&o.replies.length>0?(t(),te(A,{key:0,content:"查看此评论的所有回复",placement:"top","hide-after":0},{default:l(()=>[i(g,{size:"small",text:"",onClick:k=>ne(o.id)},{default:l(()=>{var k;return[f[13]||(f[13]=e("span",{class:"material-icons-round"},"forum",-1)),r(" "+v(((k=o.replies)==null?void 0:k.length)||0),1)]}),_:2,__:[13]},1032,["onClick"])]),_:2},1024)):H("",!0)])]),I.value.includes(o.id)&&o.replies&&o.replies.length>0?(t(),a("div",Uo,[(t(!0),a(V,null,B(o.replies,k=>(t(),a("div",{key:k.id,class:"reply-item"},[e("div",Lo,[k.user&&k.user.id?(t(),te(T,{key:0,to:{name:"userProfile",params:{id:k.user.id}},class:"user-link"},{default:l(()=>[e("span",Eo,v(k.user.username),1)]),_:2},1032,["to"])):(t(),a("span",Do,"未知用户")),e("span",Po,v(Y(ke)(k.created_at)),1)]),e("div",zo,v(k.content),1),e("div",Fo,[i(g,{size:"small",text:"",onClick:q=>L(k.id)},{default:l(()=>[f[14]||(f[14]=e("span",{class:"material-icons-round"},"thumb_up",-1)),r(" "+v(k.like_count||0),1)]),_:2,__:[14]},1032,["onClick"]),i(g,{size:"small",text:"",onClick:q=>O(o.id,k.user.id)},{default:l(()=>f[15]||(f[15]=[e("span",{class:"material-icons-round"},"reply",-1),r(" 回复 ")])),_:2,__:[15]},1032,["onClick"])])]))),128))])):H("",!0),o.is_solution?(t(),a("div",Vo,f[16]||(f[16]=[e("span",{class:"material-icons-round"},"verified",-1),r(" 最佳回答 ")]))):H("",!0)]))),128))]))])]),_:1},8,["modelValue"])])}}}),Ro=Ce(Ho,[["__scopeId","data-v-d1cae3fc"]]),Oo={class:"main-content"},Bo={class:"sidebar-inner"},Go={class:"sidebar-block"},Ko={key:0,class:"sidebar-loading"},Wo={key:1,class:"sidebar-menu"},Yo={class:"material-icons-round menu-icon"},Zo={class:"sidebar-block"},qo={key:0,class:"sidebar-loading"},Qo={key:1,class:"tag-cloud"},jo={class:"sidebar-block"},Xo={key:0,class:"sidebar-loading"},Jo={key:1,class:"stats-list"},ea={class:"stat-item"},sa={class:"stat-value font-rounded"},ta={class:"stat-item"},oa={class:"stat-value font-rounded"},aa={class:"stat-item"},na={class:"stat-value font-rounded"},la={class:"content-main"},ia={key:1,class:"sidebar sidebar-right"},ra={class:"sidebar-inner"},da={class:"sidebar-block"},ca={key:0,class:"sidebar-loading"},ua={key:1,class:"user-list"},va=["src","alt"],ma={class:"user-info"},pa={class:"user-name font-rounded"},_a={class:"user-title"},fa={class:"sidebar-block"},ga={key:0,class:"sidebar-loading"},ha={key:1,class:"hot-topics"},ba={class:"topic-content"},ya={class:"topic-meta"},ka={class:"topic-views"},wa={class:"topic-comments"},$a={class:"sidebar-block"},Ca={key:0,class:"sidebar-loading"},Sa={key:1,class:"recommended-posts"},Aa={class:"post-category"},Ta={class:"post-title"},xa={class:"post-author"},Ma=["src","alt"],Ia={class:"author-name"},Ua={class:"sidebar-block announcement-block"},La={class:"announcements"},Ea={class:"announcement-date"},Da={class:"announcement-content"},Pa={class:"sidebar-block"},za={key:0,class:"sidebar-loading"},Fa={key:1,class:"activity-list"},Va={class:"activity-content"},Na=["innerHTML"],Ha={class:"activity-time"},Ra={key:2,class:"sidebar sidebar-right post-detail-sidebar"},Oa={class:"sidebar-inner"},Ba={key:3,class:"sidebar sidebar-right"},Ga={class:"sidebar-inner"},Ka={class:"sidebar-block"},Wa={class:"data-grid"},Ya={class:"data-item"},Za={class:"data-value"},qa={class:"data-item"},Qa={class:"data-value"},ja={class:"data-item"},Xa={class:"data-value"},Ja={class:"sidebar-block join-block"},en={key:4,class:"sidebar sidebar-right user-profile-sidebar"},sn={class:"sidebar-inner"},tn={class:"sidebar-card"},on={class:"card-body"},an={key:0,class:"empty-achievements"},nn={key:1,class:"achievements-list"},ln={class:"material-icons-round"},rn={class:"achievement-info"},dn={class:"achievement-name"},cn={class:"achievement-desc"},un={class:"achievement-date"},vn={class:"sidebar-card"},mn={class:"card-body"},pn={class:"contact-info"},_n={key:0,class:"contact-item"},fn={class:"contact-text"},gn={key:1,class:"contact-item"},hn=["href"],bn={key:2,class:"contact-item"},yn={class:"contact-text"},kn={key:3,class:"empty-contact"},wn={class:"sidebar-card"},$n={class:"card-body"},Cn={key:0,class:"empty-skills"},Sn={key:1,class:"skills-list"},An={class:"sidebar-card"},Tn={class:"card-body"},xn={key:0,class:"empty-social"},Mn={key:1,class:"social-links"},In=["href","title"],Un={class:"material-icons-round"},Ln={class:"social-name"},En={class:"sidebar-card"},Dn={class:"card-body"},Pn={key:0,class:"empty-recommended"},zn={key:1,class:"recommended-users"},Fn=["src","alt"],Vn={class:"user-info"},Nn={class:"user-name"},Hn={class:"user-title"},Rn={class:"sidebar-card"},On={class:"card-body"},Bn={key:0,class:"empty-categories"},Gn={key:1,class:"categories-list"},Kn={class:"category-info"},Wn={key:1,class:"category-name"},Yn={class:"category-count"},Zn={class:"sidebar-card"},qn={class:"card-body"},Qn={key:0,class:"empty-activities"},jn={key:1,class:"activities-list"},Xn={class:"activity-icon"},Jn={class:"material-icons-round"},el={class:"activity-content"},sl=["innerHTML"],tl={class:"activity-time"},ol={class:"sidebar-card"},al={class:"card-body"},nl={key:0,class:"empty-tags"},ll={key:1,class:"tags-cloud"},il=$e({__name:"MainLayout",setup(c){qe();const p=Ie(),_=fs(),w=b(!1),{isMobile:C,isTablet:$,isDesktop:I,currentBreakpoint:m}=Ze(),{getPadding:h}=Cs(),U=b(!1),y=M(()=>{const s=!["login","notFound","createPost","editPost"].includes(_.name);return C.value?s&&U.value:s}),D=()=>{U.value=!1},G=M(()=>({"layout-mobile":C.value,"layout-tablet":$.value,"layout-desktop":I.value,[`layout-${m.value}`]:!0})),P=M(()=>({"full-width":E.value,"post-detail-layout":L.value,"mobile-layout":C.value,"tablet-layout":$.value})),Z=M(()=>({"sidebar-mobile":C.value,"sidebar-tablet":$.value,"sidebar-open":U.value})),le=M(()=>({padding:h("16px","24px","32px").value,maxWidth:C.value?"100%":$.value?"1024px":"1200px"})),ne=M(()=>["home","category","search"].includes(_.name)),L=M(()=>_.name==="postDetail"),O=M(()=>_.name==="about"),X=M(()=>_.name==="userProfile"),E=M(()=>["createPost","editPost"].includes(_.name)),f=M(()=>L.value?_.params.id:null),g=b(null),A=M(()=>p.currentUser&&g.value&&p.currentUser.id===g.value.id),S=b({categories:!1,popularTags:!1,stats:!1,activeUsers:!1,recentActivities:!1,hotTopics:!1,recommendedPosts:!1}),T=b([]),o=()=>R(null,null,function*(){S.value.categories=!0;try{const u=yield Ve.getCategories();T.value=u||[]}catch(u){}finally{S.value.categories=!1}}),k=b([{name:"生活技巧",count:156},{name:"美食推荐",count:89},{name:"户外探险",count:67},{name:"职场经验",count:45},{name:"装修攻略",count:34},{name:"养生健康",count:28},{name:"旅游景点",count:23},{name:"学习方法",count:19}]),q=()=>R(null,null,function*(){S.value.popularTags=!0,setTimeout(()=>{S.value.popularTags=!1},500)}),ee=b({users:"0",posts:"0",comments:"0"}),me=()=>R(null,null,function*(){S.value.stats=!0,setTimeout(()=>{ee.value={users:"1.2K",posts:"3.5K",comments:"8.9K"},S.value.stats=!1},500)}),ue=b([]),Q=()=>R(null,null,function*(){S.value.activeUsers=!0;try{const u=yield We.getActiveUsers(0,5);ue.value=u||[]}catch(u){}finally{S.value.activeUsers=!1}}),Se=b([{type:"post",user:{username:"小明"},post:{title:"分享一个超实用的收纳技巧"},time:"2分钟前"},{type:"comment",user:{username:"小红"},post:{title:"如何制作美味的家常菜"},time:"5分钟前"},{type:"like",user:{username:"小李"},post:{title:"户外徒步装备推荐"},time:"10分钟前"}]),Ue=()=>R(null,null,function*(){S.value.recentActivities=!0,setTimeout(()=>{S.value.recentActivities=!1},500)}),pe=b([]),Le=()=>R(null,null,function*(){S.value.hotTopics=!0;try{const u=yield Ne.getHotPostsSide(0,5);pe.value=u||[]}catch(u){pe.value=[{id:1,title:"生活小技巧分享",viewCount:1200,commentCount:45},{id:2,title:"美食制作心得",viewCount:980,commentCount:32},{id:3,title:"旅游攻略推荐",viewCount:756,commentCount:28},{id:4,title:"健康养生知识",viewCount:634,commentCount:21},{id:5,title:"职场经验分享",viewCount:523,commentCount:18}]}finally{S.value.hotTopics=!1}}),x=b([]),n=()=>R(null,null,function*(){S.value.recommendedPosts=!0;try{const u=yield Ne.getRecommendedPostsSide(0,3);x.value=u||[]}catch(u){x.value=[{id:1,title:"新手必看：论坛使用指南",category:{name:"新手指南"}},{id:2,title:"精选：最实用的生活技巧合集",category:{name:"生活技巧"}},{id:3,title:"社区规则与发帖须知",category:{name:"社区公告"}}]}finally{S.value.recommendedPosts=!1}}),J=b([{date:new Date().getTime()-1e3*60*60*24*2,content:"论坛将于本周六进行系统升级，可能会有短暂的服务中断"},{date:new Date().getTime()-1e3*60*60*24*5,content:'欢迎参与"我的家居改造"主题征文活动，优秀作品将获得精美礼品'}]),de=b([{name:"优质创作者",description:"发布10篇高质量帖子",icon:"auto_awesome",level:"gold",date:"2023-04-15T00:00:00Z"},{name:"活跃评论者",description:"发表30条评论",icon:"comment",level:"silver",date:"2023-03-10T00:00:00Z"},{name:"新手上路",description:"成功注册并完善个人资料",icon:"person",level:"bronze",date:"2023-01-01T00:00:00Z"}]),he=b([{name:"家居设计",level:90},{name:"植物养护",level:75},{name:"摄影",level:60},{name:"烹饪",level:85},{name:"DIY手工",level:70}]),Ae=b([{name:"微博",icon:"public",url:"https://weibo.com/username"},{name:"知乎",icon:"help_outline",url:"https://zhihu.com/people/username"},{name:"小红书",icon:"book",url:"https://xiaohongshu.com/user/profile/username"},{name:"GitHub",icon:"code",url:"https://github.com/username"}]),Te=b([{id:101,username:"创意达人",avatar:"",title:"家居设计师"},{id:102,username:"美食家",avatar:"",title:"烹饪爱好者"},{id:103,username:"旅行者",avatar:"",title:"环球旅行家"}]),ie=b([{id:1,name:"家居装饰",count:8},{id:2,name:"厨房收纳",count:5},{id:3,name:"极简主义",count:7},{id:4,name:"手工DIY",count:3},{id:5,name:"植物养护",count:6},{id:6,name:"旅行攻略",count:4},{id:7,name:"摄影技巧",count:2}]),be=b([{id:2,name:"家居装饰",post_count:8,total_posts:12},{id:1,name:"生活技巧",post_count:3,total_posts:12},{id:4,name:"旅行探索",post_count:1,total_posts:12}]),xe=b([{type:"post",content:'发布了帖子 <a href="#">如何打造舒适的居家办公环境</a>',time:new Date(Date.now()-2*60*60*1e3).toISOString()},{type:"comment",content:'评论了帖子 <a href="#">10种常见室内植物的养护方法</a>',time:new Date(Date.now()-5*60*60*1e3).toISOString()},{type:"like",content:'收藏了帖子 <a href="#">小户型收纳技巧分享</a>',time:new Date(Date.now()-1*24*60*60*1e3).toISOString()},{type:"achievement",content:"获得成就 <strong>活跃评论者</strong>",time:new Date(Date.now()-3*24*60*60*1e3).toISOString()}]),Ee=u=>{if(!u)return"未知日期";try{const s=new Date(u);return isNaN(s.getTime())?"无效日期":`${s.getMonth()+1}月${s.getDate()}日`}catch(s){return console.warn("格式化公告日期失败:",u,s),"日期格式错误"}},Me=u=>{var re,ve;if(!u)return"未知活动";const s=((re=u.user)==null?void 0:re.username)||"未知用户",K=((ve=u.post)==null?void 0:ve.title)||"未知帖子";switch(u.type){case"post":return`<strong>${s}</strong> 发布了 <strong>${K}</strong>`;case"comment":return`<strong>${s}</strong> 评论了 <strong>${K}</strong>`;case"like":return`<strong>${s}</strong> 赞了 <strong>${K}</strong>`;default:return`<strong>${s}</strong> 进行了某项活动`}},z=u=>{switch(u){case"post":return"post_add";case"comment":return"comment";case"like":return"thumb_up";default:return"notifications"}},oe=u=>`activity-icon-${u}`,_e=u=>{if(!u)return"未知时间";try{const s=new Date(u);return isNaN(s.getTime())?"无效时间":ke(s.toISOString())}catch(s){return console.warn("格式化时间失败:",u,s),"时间格式错误"}},je=u=>{switch(u){case"post":return"post_add";case"comment":return"comment";case"like":return"favorite";case"achievement":return"emoji_events";default:return"notifications"}},Xe=u=>(u==null?void 0:u.content)||"无内容",Je=u=>{if(!u)return 0;const s=u.postCount||u.post_count||0,K=u.totalPosts||u.total_posts||1;return K===0?0:Math.round(s/K*100)},es=u=>{const s=["#409eff","#67c23a","#e6a23c","#f56c6c","#909399"],K=Math.abs(u||0);return s[K%s.length]},ss=u=>{if(!u)return"category";switch(u){case"生活技巧":return"lightbulb_outline";case"家居装饰":return"home";case"美食烹饪":return"restaurant";case"旅行探索":return"directions_walk";case"健康养生":return"healing";case"职场技能":return"work";default:return"category"}},ts=u=>{const s=["primary","success","warning","danger","info"],K=Math.abs(u||0);return s[K%s.length]},os=u=>{if(!u||typeof u!="string")return"";try{return new URL(u).hostname}catch(s){return u}},as=u=>{if(!u||u<=0||!ie.value||ie.value.length===0)return"12px";try{const re=ie.value.map(d=>(d==null?void 0:d.count)||0).filter(d=>d>0);if(re.length===0)return"12px";const ve=Math.max(...re);if(ve===0)return"12px";const De=12+u/ve*8;return`${Math.round(De)}px`}catch(re){return console.warn("计算标签大小失败:",u,re),"12px"}},ns=u=>{if(!u){console.warn("无法关注：用户ID不存在");return}},ls=u=>{if(!u){console.warn("无法滚动：评论ID不存在");return}const s=new CustomEvent("scrollToComments",{detail:{commentId:u}});window.dispatchEvent(s)},is=()=>{const u=new CustomEvent("scrollToCommentForm");window.dispatchEvent(u)};return we(()=>R(null,null,function*(){if(o(),q(),me(),ne.value&&(Q(),Ue(),Le(),n()),X.value){const u=Array.isArray(_.params.id)?_.params.id[0]:_.params.id;if(u)try{const s=yield We.getUserById(Number(u));g.value=s.data||null}catch(s){console.error("获取用户数据失败:",s)}}})),(u,s)=>{const K=N("router-link"),re=N("el-button"),ve=N("el-progress"),De=N("el-tag");return t(),a("div",{class:se(["app-layout",G.value])},[i(It),Y(C)&&U.value?(t(),a("div",{key:0,class:"sidebar-overlay",onClick:D})):H("",!0),e("main",Oo,[e("div",{class:"container main-container",style:ge(le.value)},[e("div",{class:se(["content-wrapper",P.value])},[y.value?(t(),a("aside",{key:0,class:se(["sidebar",Z.value])},[e("div",Bo,[e("div",Go,[s[1]||(s[1]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"category"),r(" 分类导航 ")],-1)),S.value.categories?(t(),a("div",Ko,s[0]||(s[0]=[e("span",{class:"material-icons-round loading-icon"},"sync",-1),e("span",null,"加载中...",-1)]))):(t(),a("ul",Wo,[(t(!0),a(V,null,B(T.value,d=>(t(),a("li",{key:d.id},[d.id?(t(),te(K,{key:0,to:{name:"category",params:{id:d.id}}},{default:l(()=>[e("span",Yo,v(ss(d.name||"")),1),r(" "+v(d.name||"未知分类"),1)]),_:2},1032,["to"])):H("",!0)]))),128))]))]),e("div",Zo,[s[3]||(s[3]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"local_fire_department"),r(" 热门话题 ")],-1)),S.value.popularTags?(t(),a("div",qo,s[2]||(s[2]=[e("span",{class:"material-icons-round loading-icon"},"sync",-1),e("span",null,"加载中...",-1)]))):(t(),a("div",Qo,[(t(!0),a(V,null,B(k.value,d=>(t(),te(K,{key:d.id,to:{name:"search",query:{tag:d.id}},class:"tag-item font-rounded"},{default:l(()=>[r(v(d.name),1)]),_:2},1032,["to"]))),128))]))]),e("div",jo,[s[8]||(s[8]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"analytics"),r(" 社区统计 ")],-1)),S.value.stats?(t(),a("div",Xo,s[4]||(s[4]=[e("span",{class:"material-icons-round loading-icon"},"sync",-1),e("span",null,"加载中...",-1)]))):(t(),a("div",Jo,[e("div",ea,[s[5]||(s[5]=e("div",{class:"stat-icon-wrapper"},[e("span",{class:"material-icons-round stat-icon"},"people"),e("span",{class:"stat-label"},"用户")],-1)),e("span",sa,v(ee.value.users),1)]),e("div",ta,[s[6]||(s[6]=e("div",{class:"stat-icon-wrapper"},[e("span",{class:"material-icons-round stat-icon"},"article"),e("span",{class:"stat-label"},"帖子")],-1)),e("span",oa,v(ee.value.posts),1)]),e("div",aa,[s[7]||(s[7]=e("div",{class:"stat-icon-wrapper"},[e("span",{class:"material-icons-round stat-icon"},"comment"),e("span",{class:"stat-label"},"评论")],-1)),e("span",na,v(ee.value.comments),1)])]))])])],2)):H("",!0),e("div",la,[gs(u.$slots,"default",{},void 0,!0)]),ne.value&&!L.value&&!O.value?(t(),a("aside",ia,[e("div",ra,[e("div",da,[s[10]||(s[10]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"group"),r(" 活跃用户 ")],-1)),S.value.activeUsers?(t(),a("div",ca,s[9]||(s[9]=[e("span",{class:"material-icons-round loading-icon"},"sync",-1),e("span",null,"加载中...",-1)]))):(t(),a("ul",ua,[(t(!0),a(V,null,B(ue.value,d=>(t(),a("li",{key:d.id,class:"user-item"},[i(K,{to:{name:"userProfile",params:{id:d.id}}},{default:l(()=>[e("img",{src:d.avatar||"/default-avatar.png",alt:d.username,class:"user-avatar"},null,8,va),e("div",ma,[e("span",pa,v(d.username),1),e("small",_a,v(d.title||"论坛用户"),1)])]),_:2},1032,["to"])]))),128))]))]),e("div",fa,[s[14]||(s[14]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"trending_up"),r(" 热门话题 ")],-1)),S.value.hotTopics?(t(),a("div",ga,s[11]||(s[11]=[e("span",{class:"material-icons-round loading-icon"},"sync",-1),e("span",null,"加载中...",-1)]))):(t(),a("div",ha,[(t(!0),a(V,null,B(pe.value,(d,F)=>(t(),a("div",{key:F,class:"hot-topic-item"},[e("div",{class:se(["topic-rank font-rounded",{"top-rank":F<3}])},v(F+1),3),e("div",ba,[i(K,{to:{name:"postDetail",params:{id:d.id}},class:"topic-title font-rounded"},{default:l(()=>[r(v(d.title),1)]),_:2},1032,["to"]),e("div",ya,[e("span",ka,[s[12]||(s[12]=e("span",{class:"material-icons-round"},"visibility",-1)),r(" "+v(d.views),1)]),e("span",wa,[s[13]||(s[13]=e("span",{class:"material-icons-round"},"comment",-1)),r(" "+v(d.comments),1)])])])]))),128))]))]),e("div",$a,[s[16]||(s[16]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"bookmark"),r(" 推荐阅读 ")],-1)),S.value.recommendedPosts?(t(),a("div",Ca,s[15]||(s[15]=[e("span",{class:"material-icons-round loading-icon"},"sync",-1),e("span",null,"加载中...",-1)]))):(t(),a("div",Sa,[(t(!0),a(V,null,B(x.value,(d,F)=>(t(),a("div",{key:F,class:"recommended-post"},[i(K,{to:{name:"postDetail",params:{id:d.id}}},{default:l(()=>[e("div",Aa,v(d.category),1),e("div",Ta,v(d.title),1),e("div",xa,[e("img",{src:d.author.avatar||"/default-avatar.png",alt:d.author.name,class:"author-avatar"},null,8,Ma),e("span",Ia,v(d.author.name),1)])]),_:2},1032,["to"])]))),128))]))]),e("div",Ua,[s[17]||(s[17]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"campaign"),r(" 社区公告 ")],-1)),e("div",La,[(t(!0),a(V,null,B(J.value,(d,F)=>(t(),a("div",{key:F,class:"announcement-item"},[e("div",Ea,v(Ee(d.date)),1),e("div",Da,v(d.content),1)]))),128))])]),e("div",Pa,[s[19]||(s[19]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"history"),r(" 最近活动 ")],-1)),S.value.recentActivities?(t(),a("div",za,s[18]||(s[18]=[e("span",{class:"material-icons-round loading-icon"},"sync",-1),e("span",null,"加载中...",-1)]))):(t(),a("ul",Fa,[(t(!0),a(V,null,B(Se.value,(d,F)=>(t(),a("li",{key:F,class:"activity-item"},[e("span",{class:se(["material-icons-round activity-icon",oe(d.type)])},v(z(d.type)),3),e("div",Va,[e("p",{innerHTML:Me(d)},null,8,Na),e("small",Ha,v(_e(d.time)),1)])]))),128))]))])])])):H("",!0),L.value?(t(),a("aside",Ra,[e("div",Oa,[i(Ro,{postId:f.value,onScrollToComments:ls,onScrollToCommentForm:is},null,8,["postId"])])])):H("",!0),O.value?(t(),a("aside",Ba,[e("div",Ga,[s[28]||(s[28]=Fe('<div class="sidebar-block" data-v-b27fe3ad><h3 class="sidebar-title font-rounded letter-tight" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>contact_support</span> 联系我们 </h3><div class="contact-card" data-v-b27fe3ad><div class="contact-item" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>email</span><a href="mailto:contact@lumen-forum.com" class="font-rounded" data-v-b27fe3ad>contact@lumen-forum.com</a></div><div class="contact-item" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>phone</span><span class="font-rounded" data-v-b27fe3ad>400-123-4567</span></div><div class="contact-item" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>location_on</span><span data-v-b27fe3ad>北京市海淀区科技园区88号</span></div></div></div><div class="sidebar-block" data-v-b27fe3ad><h3 class="sidebar-title font-rounded letter-tight" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>menu_book</span> 社区指南 </h3><div class="guide-list" data-v-b27fe3ad><a href="#" class="guide-item" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>description</span><span data-v-b27fe3ad>社区规则</span></a><a href="#" class="guide-item" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>security</span><span data-v-b27fe3ad>隐私政策</span></a><a href="#" class="guide-item" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>info</span><span data-v-b27fe3ad>常见问题</span></a><a href="#" class="guide-item" data-v-b27fe3ad><span class="material-icons-round" data-v-b27fe3ad>help</span><span data-v-b27fe3ad>帮助中心</span></a></div></div>',2)),e("div",Ka,[s[24]||(s[24]=e("h3",{class:"sidebar-title"},[e("span",{class:"material-icons-round"},"bar_chart"),r(" 社区数据 ")],-1)),e("div",Wa,[e("div",Ya,[e("div",Za,v(ee.value.users),1),s[20]||(s[20]=e("div",{class:"data-label"},"注册用户",-1))]),e("div",qa,[e("div",Qa,v(ee.value.posts),1),s[21]||(s[21]=e("div",{class:"data-label"},"发布帖子",-1))]),e("div",ja,[e("div",Xa,v(ee.value.comments),1),s[22]||(s[22]=e("div",{class:"data-label"},"回复评论",-1))]),s[23]||(s[23]=e("div",{class:"data-item"},[e("div",{class:"data-value"},"99%"),e("div",{class:"data-label"},"用户满意度")],-1))])]),e("div",Ja,[s[26]||(s[26]=e("h3",{class:"sidebar-title font-rounded letter-tight"},[e("span",{class:"material-icons-round"},"person_add"),r(" 加入我们的社区 ")],-1)),s[27]||(s[27]=e("p",{class:"join-text"},"成为Lumen社区的一员，分享你的知识和经验",-1)),i(re,{type:"primary",class:"join-btn",onClick:w.value},{default:l(()=>s[25]||(s[25]=[r("立即加入")])),_:1,__:[25]},8,["onClick"])])])])):H("",!0),X.value?(t(),a("aside",en,[e("div",sn,[e("div",tn,[s[30]||(s[30]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"emoji_events"),r(" 用户成就 ")])],-1)),e("div",on,[de.value.length===0?(t(),a("div",an,s[29]||(s[29]=[e("p",null,"暂无成就",-1)]))):(t(),a("div",nn,[(t(!0),a(V,null,B(de.value,(d,F)=>(t(),a("div",{key:F,class:"achievement-item"},[e("div",{class:se(["achievement-icon",d.level])},[e("span",ln,v(d.icon),1)],2),e("div",rn,[e("div",dn,v(d.name),1),e("div",cn,v(d.description),1),e("div",un,"获得于 "+v(Y(Qe)(d.date)),1)])]))),128))]))])]),e("div",vn,[s[35]||(s[35]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"contact_mail"),r(" 联系信息 ")])],-1)),e("div",mn,[e("div",pn,[g.value&&g.value.email&&(A.value||g.value.show_email)?(t(),a("div",_n,[s[31]||(s[31]=e("span",{class:"material-icons-round"},"email",-1)),e("span",fn,v(g.value.email),1)])):H("",!0),g.value&&g.value.website?(t(),a("div",gn,[s[32]||(s[32]=e("span",{class:"material-icons-round"},"language",-1)),e("a",{href:g.value.website,target:"_blank",class:"contact-link"},v(os(g.value.website)),9,hn)])):H("",!0),g.value&&g.value.location?(t(),a("div",bn,[s[33]||(s[33]=e("span",{class:"material-icons-round"},"location_on",-1)),e("span",yn,v(g.value.location),1)])):H("",!0),!g.value||!g.value.email&&!g.value.website&&!g.value.location?(t(),a("div",kn,s[34]||(s[34]=[e("p",null,"暂无联系信息",-1)]))):H("",!0)])])]),e("div",wn,[s[37]||(s[37]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"auto_awesome"),r(" 技能标签 ")])],-1)),e("div",$n,[he.value.length===0?(t(),a("div",Cn,s[36]||(s[36]=[e("p",null,"暂无技能标签",-1)]))):(t(),a("div",Sn,[(t(!0),a(V,null,B(he.value,(d,F)=>(t(),te(De,{key:F,type:ts(F),class:"skill-tag",effect:"light"},{default:l(()=>[r(v(d.name)+" ",1),i(ve,{percentage:d.level,"show-text":!1,"stroke-width":4,class:"skill-progress"},null,8,["percentage"])]),_:2},1032,["type"]))),128))]))])]),e("div",An,[s[39]||(s[39]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"share"),r(" 社交媒体 ")])],-1)),e("div",Tn,[Ae.value.length===0?(t(),a("div",xn,s[38]||(s[38]=[e("p",null,"暂无社交媒体链接",-1)]))):(t(),a("div",Mn,[(t(!0),a(V,null,B(Ae.value,(d,F)=>(t(),a("a",{key:F,href:d.url,target:"_blank",class:"social-link",title:d.name},[e("span",Un,v(d.icon),1),e("span",Ln,v(d.name),1)],8,In))),128))]))])]),e("div",En,[s[42]||(s[42]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"person_add"),r(" 推荐关注 ")])],-1)),e("div",Dn,[Te.value.length===0?(t(),a("div",Pn,s[40]||(s[40]=[e("p",null,"暂无推荐用户",-1)]))):(t(),a("div",zn,[(t(!0),a(V,null,B(Te.value,(d,F)=>(t(),a("div",{key:F,class:"recommended-user"},[i(K,{to:{name:"userProfile",params:{id:d.id}},class:"user-link"},{default:l(()=>[e("img",{src:d.avatar||"/default-avatar.png",alt:d.username,class:"user-avatar"},null,8,Fn),e("div",Vn,[e("div",Nn,v(d.username),1),e("div",Hn,v(d.title||"论坛用户"),1)])]),_:2},1032,["to"]),i(re,{size:"small",type:"primary",plain:"",onClick:rl=>ns(d.id)},{default:l(()=>s[41]||(s[41]=[e("span",{class:"material-icons-round"},"person_add",-1)])),_:2,__:[41]},1032,["onClick"])]))),128))]))])]),e("div",Rn,[s[44]||(s[44]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"category"),r(" 活跃分类 ")])],-1)),e("div",On,[be.value.length===0?(t(),a("div",Bn,s[43]||(s[43]=[e("p",null,"暂无活跃分类",-1)]))):(t(),a("div",Gn,[(t(!0),a(V,null,B(be.value,(d,F)=>(t(),a("div",{key:F,class:"category-item"},[e("div",Kn,[d.id?(t(),te(K,{key:0,to:{name:"category",params:{id:d.id}},class:"category-name"},{default:l(()=>[r(v(d.name||"未知分类"),1)]),_:2},1032,["to"])):(t(),a("span",Wn,v(d.name||"未知分类"),1)),e("div",Yn,v(d.postCount||d.post_count||0)+" 帖子",1)]),i(ve,{percentage:Je(d),color:es(F),"show-text":!1,"stroke-width":8,class:"category-progress"},null,8,["percentage","color"])]))),128))]))])]),e("div",Zn,[s[46]||(s[46]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"history"),r(" 最近活动 ")])],-1)),e("div",qn,[xe.value.length===0?(t(),a("div",Qn,s[45]||(s[45]=[e("p",null,"暂无活动记录",-1)]))):(t(),a("div",jn,[(t(!0),a(V,null,B(xe.value,(d,F)=>(t(),a("div",{key:F,class:"activity-item"},[e("div",Xn,[e("span",Jn,v(je(d.type)),1)]),e("div",el,[e("div",{class:"activity-text",innerHTML:Xe(d)},null,8,sl),e("div",tl,v(Y(ke)(d.time)),1)])]))),128))]))])]),e("div",ol,[s[48]||(s[48]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},[e("span",{class:"material-icons-round"},"tag"),r(" 常用标签 ")])],-1)),e("div",al,[ie.value.length===0?(t(),a("div",nl,s[47]||(s[47]=[e("p",null,"暂无常用标签",-1)]))):(t(),a("div",ll,[(t(!0),a(V,null,B(ie.value,(d,F)=>(t(),te(K,{key:F,to:{name:"search",query:{tag:d.id}},class:"tag-item",style:ge({fontSize:as(d.count)})},{default:l(()=>[r(v(d.name),1)]),_:2},1032,["to","style"]))),128))]))])])])])):H("",!0)],2)],4)]),i(Kt)],2)}}}),_l=Ce(il,[["__scopeId","data-v-b27fe3ad"]]);export{_l as M,$s as _,Ce as a,Qe as b,ke as c,pl as f,ye as g,ml as t,qe as u};

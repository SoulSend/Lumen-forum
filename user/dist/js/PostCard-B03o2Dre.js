import{x as ae,c as z,y as r,z as i,D as oe,aC as q,P as se,a6 as ne,C as le,H as w,u as o,A as l,K as y,ag as ee,V as L,I as h,M as C,O as p,Q as b,aB as re}from"./vue-vendor-D9-fr2Es.js";import{t as ce,n as ue,r as ve}from"./ui-vendor-BbrJz_TA.js";import{u as me}from"./index-D15Qezav.js";import{g as _e,a as de,t as ke,c as pe,f as H}from"./MainLayout-ce7fSWOU.js";function ie(e){var d,m,u,t,n,f,v,s,a,c,_,k,g,A,I,P,S,U,V,N,B,D,F,M,T,E,R,$;return e?{id:(d=e.id)!=null?d:0,username:(m=e.username)!=null?m:"未知用户",email:(u=e.email)!=null?u:"",avatar:(t=e.avatar)!=null?t:"/img/avatar-default.png",bio:(n=e.bio)!=null?n:"",showEmail:(f=e.showEmail)!=null?f:!1,reputation:(v=e.reputation)!=null?v:0,postCount:(a=(s=e.postCount)!=null?s:e.post_count)!=null?a:0,commentCount:(_=(c=e.commentCount)!=null?c:e.comment_count)!=null?_:0,isAdmin:(g=(k=e.isAdmin)!=null?k:e.is_admin)!=null?g:!1,isModerator:(I=(A=e.isModerator)!=null?A:e.is_moderator)!=null?I:!1,phone:e.phone,website:e.website,location:e.location,title:e.title,moderatedCategory:e.moderatedCategory,emailVerifiedAt:e.emailVerifiedAt,phoneVerifiedAt:e.phoneVerifiedAt,lastActiveAt:(P=e.lastActiveAt)!=null?P:e.last_active_at,rememberToken:e.rememberToken,deleted:e.deleted,createdAt:(S=e.createdAt)!=null?S:e.created_at,updatedAt:(U=e.updatedAt)!=null?U:e.updated_at,created_at:(V=e.created_at)!=null?V:e.createdAt,updated_at:(N=e.updated_at)!=null?N:e.updatedAt,last_active_at:(B=e.last_active_at)!=null?B:e.lastActiveAt,post_count:(D=e.post_count)!=null?D:e.postCount,comment_count:(F=e.comment_count)!=null?F:e.commentCount,is_admin:(M=e.is_admin)!=null?M:e.isAdmin,is_moderator:(T=e.is_moderator)!=null?T:e.isModerator,show_email:(E=e.show_email)!=null?E:e.showEmail,cover_image:e.cover_image,skills:(R=e.skills)!=null?R:[],social_links:($=e.social_links)!=null?$:[]}:{id:0,username:"未知用户",email:"",avatar:"/img/avatar-default.png",bio:"",showEmail:!1,reputation:0,postCount:0,commentCount:0,isAdmin:!1,isModerator:!1}}function fe(e){var d,m,u,t,n,f,v,s,a,c,_,k,g,A,I,P,S,U,V,N,B,D,F,M,T,E,R,$,W,G,J,X,Y,Z,j,x;return e?{id:(d=e.id)!=null?d:0,title:(m=e.title)!=null?m:"未知标题",content:(u=e.content)!=null?u:"",userId:(n=(t=e.userId)!=null?t:e.user_id)!=null?n:0,categoryId:(v=(f=e.categoryId)!=null?f:e.category_id)!=null?v:0,viewCount:(a=(s=e.viewCount)!=null?s:e.view_count)!=null?a:0,likeCount:(_=(c=e.likeCount)!=null?c:e.like_count)!=null?_:0,commentCount:(g=(k=e.commentCount)!=null?k:e.comment_count)!=null?g:0,isPinned:(I=(A=e.isPinned)!=null?A:e.is_pinned)!=null?I:!1,isFeatured:(S=(P=e.isFeatured)!=null?P:e.is_featured)!=null?S:!1,isSolved:(V=(U=e.isSolved)!=null?U:e.is_solved)!=null?V:!1,isRecommended:(N=e.isRecommended)!=null?N:!1,solutionCommentId:(D=(B=e.solutionCommentId)!=null?B:e.solution_comment_id)!=null?D:null,deleted:e.deleted,createdAt:(F=e.createdAt)!=null?F:e.created_at,updatedAt:(M=e.updatedAt)!=null?M:e.updated_at,user:e.user?ie(e.user):void 0,category:e.category?Ce(e.category):void 0,tags:(T=e.tags)!=null?T:[],created_at:(E=e.created_at)!=null?E:e.createdAt,updated_at:(R=e.updated_at)!=null?R:e.updatedAt,user_id:($=e.user_id)!=null?$:e.userId,category_id:(W=e.category_id)!=null?W:e.categoryId,view_count:(G=e.view_count)!=null?G:e.viewCount,like_count:(J=e.like_count)!=null?J:e.likeCount,comment_count:(X=e.comment_count)!=null?X:e.commentCount,is_pinned:(Y=e.is_pinned)!=null?Y:e.isPinned,is_featured:(Z=e.is_featured)!=null?Z:e.isFeatured,is_solved:(j=e.is_solved)!=null?j:e.isSolved,solution_comment_id:(x=e.solution_comment_id)!=null?x:e.solutionCommentId,is_liked:e.is_liked,is_bookmarked:e.is_bookmarked}:{id:0,title:"未知标题",content:"",userId:0,categoryId:0,viewCount:0,likeCount:0,commentCount:0,isPinned:!1,isFeatured:!1,isSolved:!1,isRecommended:!1,solutionCommentId:null}}function Ce(e){var d,m,u,t,n,f,v,s,a,c,_,k,g,A;return e?{id:(d=e.id)!=null?d:0,name:(m=e.name)!=null?m:"未知分类",description:(u=e.description)!=null?u:"",icon:(t=e.icon)!=null?t:"",parent:e.parent,postCount:(f=(n=e.postCount)!=null?n:e.post_count)!=null?f:0,displayOrder:(v=e.displayOrder)!=null?v:0,deleted:e.deleted,createdAt:(s=e.createdAt)!=null?s:e.created_at,updatedAt:(a=e.updatedAt)!=null?a:e.updated_at,children:(c=e.children)!=null?c:[],slug:e.slug,created_at:(_=e.created_at)!=null?_:e.createdAt,updated_at:(k=e.updated_at)!=null?k:e.updatedAt,post_count:(g=e.post_count)!=null?g:e.postCount,parent_id:(A=e.parent_id)!=null?A:e.parent?e.parent.id:null}:{id:0,name:"未知分类",description:"",icon:"",parent:null,postCount:0,displayOrder:0}}function O(e){var d;return(d=e==null?void 0:e.username)!=null?d:"未知用户"}function te(e){return _e(e==null?void 0:e.avatar)}function K(e,d=0){return typeof e=="number"&&!isNaN(e)?e:d}function Q(e){return e!=null&&e.id!=null&&e.id!==0&&e.id!==""}const ge={key:0,class:"skeleton-post"},Ae={key:1,class:"skeleton-comment"},he={key:2,class:"skeleton-user"},ye={key:3,class:"skeleton-custom"},we=ae({__name:"SkeletonLoader",props:{type:{default:"custom"},lines:{default:3},animated:{type:Boolean,default:!0},loading:{type:Boolean,default:!0}},setup(e){const d=e,m=z(()=>["skeleton-loader",{"skeleton-loader--animated":d.animated,"skeleton-loader--loading":d.loading}]),u=t=>{const n=["100%","90%","75%","85%","60%"];return n[t%n.length]};return(t,n)=>(i(),r("div",{class:oe(m.value)},[t.type==="post"?(i(),r("div",ge,n[0]||(n[0]=[q('<div class="skeleton-avatar" data-v-186ec536></div><div class="skeleton-content" data-v-186ec536><div class="skeleton-title" data-v-186ec536></div><div class="skeleton-meta" data-v-186ec536><div class="skeleton-tag" data-v-186ec536></div><div class="skeleton-tag" data-v-186ec536></div><div class="skeleton-date" data-v-186ec536></div></div><div class="skeleton-text" data-v-186ec536><div class="skeleton-line" data-v-186ec536></div><div class="skeleton-line" data-v-186ec536></div><div class="skeleton-line short" data-v-186ec536></div></div><div class="skeleton-stats" data-v-186ec536><div class="skeleton-stat" data-v-186ec536></div><div class="skeleton-stat" data-v-186ec536></div><div class="skeleton-stat" data-v-186ec536></div></div></div>',2)]))):t.type==="comment"?(i(),r("div",Ae,n[1]||(n[1]=[q('<div class="skeleton-avatar small" data-v-186ec536></div><div class="skeleton-content" data-v-186ec536><div class="skeleton-username" data-v-186ec536></div><div class="skeleton-text" data-v-186ec536><div class="skeleton-line" data-v-186ec536></div><div class="skeleton-line short" data-v-186ec536></div></div></div>',2)]))):t.type==="user"?(i(),r("div",he,n[2]||(n[2]=[q('<div class="skeleton-avatar large" data-v-186ec536></div><div class="skeleton-content" data-v-186ec536><div class="skeleton-username large" data-v-186ec536></div><div class="skeleton-bio" data-v-186ec536><div class="skeleton-line" data-v-186ec536></div><div class="skeleton-line short" data-v-186ec536></div></div><div class="skeleton-stats" data-v-186ec536><div class="skeleton-stat" data-v-186ec536></div><div class="skeleton-stat" data-v-186ec536></div></div></div>',2)]))):(i(),r("div",ye,[(i(!0),r(se,null,ne(t.lines,(f,v)=>(i(),r("div",{key:v,class:"skeleton-line",style:le({width:u(v)})},null,4))),128))]))],2))}}),be=de(we,[["__scopeId","data-v-186ec536"]]),Ie={class:"post-content"},Pe={class:"post-header"},Se={class:"category-wrapper"},Ue={key:1,class:"badge badge--pin font--rounded"},Ve={key:2,class:"badge badge--solved font--rounded"},Ne={key:3,class:"badge badge--featured font--rounded"},Be={class:"post-title font--rounded"},De={key:1},Fe={class:"post-excerpt"},Me={key:0,class:"post-tags"},Te={key:0,class:"more-tags"},Ee={class:"post-meta"},Re={class:"author-info"},$e=["src","alt"],Le={class:"author-name font--rounded"},Oe={key:1,class:"author-link"},ze=["src","alt"],qe={class:"author-name font--rounded"},He={class:"post-stats"},Ke={class:"post-time"},Qe={class:"stat views"},We={class:"stat comments"},Ge={class:"stat likes"},Je=ae({__name:"PostCard",props:{post:{},loading:{type:Boolean}},setup(e){const d=e,m=re(),u=me(),t=z(()=>fe(d.post)),n=z(()=>ie(d.post.user)),f=z(()=>{if(!u.currentUser)return!1;const s=t.value.userId;return s===u.currentUser.id&&s!==0}),v=()=>{var s;if(!((s=d.post)!=null&&s.id)){console.warn("无法导航：帖子ID不存在",d.post);return}m.push({name:"postDetail",params:{id:String(d.post.id)}})};return(s,a)=>{const c=ee("router-link"),_=ee("el-icon");return s.loading?(i(),w(o(be),{key:0,type:"post",animated:!0})):(i(),r("div",{key:1,class:"post-card card card-interactive",onClick:v},[l("div",Ie,[l("div",Pe,[l("div",Se,[s.post.category&&s.post.category.id?(i(),w(c,{key:0,to:{name:"category",params:{id:s.post.category.id}},class:"badge badge--category font--rounded",onClick:a[0]||(a[0]=L(()=>{},["stop"]))},{default:h(()=>[C(p(s.post.category.name),1)]),_:1},8,["to"])):y("",!0),s.post.isPinned||s.post.is_pinned?(i(),r("span",Ue,[b(_,null,{default:h(()=>[b(o(ce))]),_:1}),a[4]||(a[4]=C("置顶 "))])):y("",!0),s.post.isSolved||s.post.is_solved?(i(),r("span",Ve,[b(_,null,{default:h(()=>[b(o(ue))]),_:1}),a[5]||(a[5]=C("已解决 "))])):y("",!0),s.post.isFeatured||s.post.is_featured?(i(),r("span",Ne,[b(_,null,{default:h(()=>[b(o(ve))]),_:1}),a[6]||(a[6]=C("精华 "))])):y("",!0)]),l("h3",Be,[o(Q)(t.value)?(i(),w(c,{key:0,to:{name:"postDetail",params:{id:t.value.id}}},{default:h(()=>[C(p(t.value.title),1)]),_:1},8,["to"])):(i(),r("span",De,p(t.value.title),1))])]),l("p",Fe,p(o(ke)(t.value.content)),1),t.value.tags&&t.value.tags.length?(i(),r("div",Me,[(i(!0),r(se,null,ne(t.value.tags.slice(0,3),k=>(i(),w(c,{key:k.id,to:{name:"search",query:{tag_id:k.id}},class:"tag",onClick:a[1]||(a[1]=L(()=>{},["stop"]))},{default:h(()=>[C(p(k.name),1)]),_:2},1032,["to"]))),128)),t.value.tags.length>3?(i(),r("span",Te,"+"+p(t.value.tags.length-3),1)):y("",!0)])):y("",!0)]),l("div",Ee,[l("div",Re,[o(Q)(n.value)?(i(),w(c,{key:0,to:{name:"userProfile",params:{id:n.value.id}},class:"author-link",onClick:a[2]||(a[2]=L(()=>{},["stop"]))},{default:h(()=>[l("img",{src:o(te)(n.value),alt:o(O)(n.value),class:"avatar avatar--small"},null,8,$e),l("span",Le,p(o(O)(n.value)),1)]),_:1},8,["to"])):(i(),r("div",Oe,[l("img",{src:o(te)(null),alt:o(O)(null),class:"avatar avatar--small"},null,8,ze),l("span",qe,p(o(O)(null)),1)]))]),l("div",He,[l("span",Ke,[a[7]||(a[7]=l("i",{class:"icon-time"},null,-1)),C(p(o(pe)(t.value.createdAt||t.value.created_at)),1)]),l("span",Qe,[a[8]||(a[8]=l("i",{class:"icon-view"},null,-1)),C(p(o(H)(o(K)(t.value.viewCount))),1)]),l("span",We,[a[9]||(a[9]=l("i",{class:"icon-comment"},null,-1)),C(p(o(H)(o(K)(t.value.commentCount))),1)]),l("span",Ge,[a[10]||(a[10]=l("i",{class:"icon-like"},null,-1)),C(p(o(H)(o(K)(t.value.likeCount))),1)]),f.value&&o(Q)(t.value)?(i(),w(c,{key:0,to:{name:"editPost",params:{id:t.value.id}},class:"edit-link",onClick:a[3]||(a[3]=L(()=>{},["stop"]))},{default:h(()=>a[11]||(a[11]=[l("span",{class:"material-icons-round edit-icon"},"edit",-1),C(" 编辑 ")])),_:1,__:[11]},8,["to"])):y("",!0)])])]))}}}),xe=de(Je,[["__scopeId","data-v-e0b11854"]]);export{xe as P,te as a,O as g,Q as h,fe as s};

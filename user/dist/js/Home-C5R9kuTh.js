var w=(Q,L,y)=>new Promise((k,f)=>{var A=c=>{try{C(y.next(c))}catch(h){f(h)}},M=c=>{try{C(y.throw(c))}catch(h){f(h)}},C=c=>c.done?k(c.value):Promise.resolve(c.value).then(A,M);C((y=y.apply(Q,L)).next())});import{x as wt,r as _,X as ct,c as rt,j as bt,h as Tt,H as b,I as p,z as a,A as t,Q as d,M as m,ag as g,a4 as Nt,u as n,O as l,y as i,K as V,P as z,a6 as X,aB as xt}from"./vue-vendor-D9-fr2Es.js";import{u as St,M as Vt,f as E,t as dt,b as ut,g as _t,a as Et}from"./MainLayout-ce7fSWOU.js";import{s as mt,P as Lt,g as q,a as At,h as G}from"./PostCard-B03o2Dre.js";import{u as Mt}from"./postStore-BYDGKwf5.js";import{a as Ut,o as Dt}from"./ui-vendor-BbrJz_TA.js";import{S as Ft}from"./Sidebar-D0plc26K.js";import{p as U,T as It,D as Bt}from"./index-D15Qezav.js";import"./utils-vendor-Cfc3znND.js";const Ht={class:"home-page"},Kt={class:"forum-banner"},Ot={class:"banner-content"},Rt={class:"banner-actions"},zt={class:"search-form"},Xt={class:"forum-stats"},qt={class:"stat-item"},Gt={class:"stat-content"},Qt={class:"stat-value"},Wt={class:"stat-item"},jt={class:"stat-content"},$t={class:"stat-value"},Jt={class:"stat-item"},Yt={class:"stat-content"},Zt={class:"stat-value"},ts={class:"forum-content"},ss={class:"content-main"},es={class:"content-section posts-section"},as={class:"section-header"},os={class:"section-actions"},ns={key:0,class:"posts-loading"},ls={key:1,class:"no-posts"},is={key:2,class:"posts-list"},cs={key:0,class:"load-more"},rs={class:"content-section featured-section"},ds={key:0,class:"loading-container"},us={key:1,class:"no-content"},_s={key:2,class:"featured-grid"},ms={key:0,class:"featured-main"},vs={class:"featured-card main-feature"},ps={class:"featured-image"},fs=["src","alt"],hs={class:"featured-content"},gs={class:"featured-category"},ys={class:"featured-title"},ks={class:"featured-excerpt"},Cs={class:"featured-meta"},Ps={class:"featured-author"},ws=["src","alt"],bs={class:"author-name"},Ts={class:"featured-date"},Ns={key:1,class:"featured-side"},xs={class:"side-feature-content"},Ss={class:"featured-category small"},Vs={class:"featured-title small"},Es={class:"featured-meta small"},Ls={class:"author-name"},As={class:"featured-date"},Ms={class:"side-feature-image"},Us=["src","alt"],Ds={class:"content-section life-tips-section"},Fs={class:"section-header"},Is={class:"section-actions"},Bs={key:0,class:"loading-container"},Hs={key:1,class:"no-content"},Ks={key:2,class:"life-tips-grid"},Os={class:"tip-card-image"},Rs=["src","alt"],zs={class:"tip-card-content"},Xs={class:"tip-title"},qs={key:1,class:"tip-title"},Gs={class:"tip-excerpt"},Qs={class:"tip-meta"},Ws={class:"tip-author"},js=["src","alt"],$s={class:"author-name"},Js={key:1,class:"author-link"},Ys=["src"],Zs={class:"author-name"},te={class:"tip-stats"},se={class:"stat views"},ee={class:"stat comments"},ae={class:"content-sidebar"},oe=wt({__name:"Home",setup(Q){const L=xt(),y=St();Mt();const k=_(""),f=ct({posts:0,users:0,solutions:0}),A=_([]),M=_(!1),C=_("all"),c=_([]),h=_(!1),D=_(!1),F=_("week"),v=ct({currentPage:1,totalPages:1,perPage:10,total:0}),T=_([]),I=_(!1),N=_([]),B=_(!1),u=rt(()=>T.value.map(o=>mt(o))),vt=rt(()=>N.value.map(o=>mt(o)));_([]),_(!1);const pt=()=>{k.value.trim()&&L.push({name:"search",query:{q:k.value}})},ft=()=>w(null,null,function*(){M.value=!0;try{const o=yield y.fetchCategories();o&&(A.value=o)}finally{M.value=!1}}),H=(o=1)=>w(null,null,function*(){var s;o===1?(h.value=!0,c.value=[]):D.value=!0;try{let r;C.value==="all"?r=yield U.getHotPosts(o-1,v.perPage):r=yield U.getCategoryPosts(C.value,o-1,v.perPage),r&&r.content&&(o===1?c.value=r.content:c.value=[...c.value,...r.content],v.currentPage=((s=r.pageable)==null?void 0:s.pageNumber)+1||o,v.totalPages=r.totalPages||1,v.total=r.totalElements||0)}catch(r){console.error("Failed to fetch posts:",r),Ut.error("获取帖子失败"),o===1&&(c.value=[],v.currentPage=1,v.totalPages=5,v.total=50)}finally{h.value=!1,D.value=!1}}),ht=()=>w(null,null,function*(){I.value=!0;try{const o=yield U.getRecommendedPostsSide(0,4);T.value=o||[]}catch(o){T.value=[{id:1,title:"新手必看：如何快速融入社区",content:"欢迎来到我们的生活技巧分享社区！这里有一些小贴士帮助你快速上手...",category:{name:"新手指南"},viewCount:1500,likeCount:89,commentCount:23},{id:2,title:"精选：最实用的厨房收纳技巧",content:"厨房空间有限？这些收纳技巧让你的厨房井井有条...",category:{name:"生活技巧"},viewCount:1200,likeCount:76,commentCount:18},{id:3,title:"健康生活：每日养生小贴士",content:"简单易行的养生方法，让你每天都充满活力...",category:{name:"健康养生"},viewCount:980,likeCount:65,commentCount:15},{id:4,title:"旅游攻略：周末短途游推荐",content:"不用走太远，周边就有很多值得一去的好地方...",category:{name:"旅游攻略"},viewCount:756,likeCount:42,commentCount:12}]}finally{I.value=!1}}),gt=()=>w(null,null,function*(){var o;B.value=!0;try{const s=((o=A.value.find(K=>K.name==="生活技巧"))==null?void 0:o.id)||1,r=yield U.getCategoryPosts(s,0,4);N.value=(r==null?void 0:r.content)||[]}catch(s){N.value=[{id:1,title:"厨房收纳的5个小技巧",content:"让你的厨房空间利用率翻倍...",viewCount:856,likeCount:45,commentCount:12},{id:2,title:"衣物保养实用指南",content:"延长衣物寿命的小窍门...",viewCount:723,likeCount:38,commentCount:9},{id:3,title:"家居清洁的高效方法",content:"省时省力的清洁技巧分享...",viewCount:645,likeCount:32,commentCount:7},{id:4,title:"节能环保生活小贴士",content:"从小事做起，保护我们的地球...",viewCount:567,likeCount:28,commentCount:6}]}finally{B.value=!1}}),yt=()=>w(null,null,function*(){f.posts=3500,f.users=1200,f.solutions=890}),kt=()=>{H(v.currentPage+1)},Ct=o=>{L.push(o)};return bt(F,()=>{H(1)}),Tt(()=>{ft(),H(),ht(),yt(),gt()}),(o,s)=>{const r=g("el-button"),K=g("el-input"),O=g("el-radio-button"),Pt=g("el-radio-group"),P=g("el-skeleton"),R=g("el-empty"),x=g("router-link");return a(),b(Vt,null,{default:p(()=>{var W,j,$,J,Y,Z,tt,st,et,at,ot;return[t("div",Ht,[t("section",Kt,[t("div",Ot,[s[4]||(s[4]=t("div",{class:"banner-text"},[t("h1",{class:"banner-title"},"Lumen 论坛"),t("p",{class:"banner-description"},"分享生活智慧，发现日常精彩")],-1)),t("div",Rt,[d(r,{type:"primary",size:"large",class:"action-button",onClick:s[0]||(s[0]=e=>Ct("/create-post"))},{default:p(()=>s[3]||(s[3]=[t("i",{class:"icon-plus"},null,-1),m(" 发布新帖 ")])),_:1,__:[3]}),t("div",zt,[d(K,{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=e=>k.value=e),placeholder:"搜索感兴趣的内容...","prefix-icon":n(Dt),class:"search-input",onKeyup:Nt(pt,["enter"]),clearable:""},null,8,["modelValue","prefix-icon"])])])]),t("div",Xt,[t("div",qt,[s[6]||(s[6]=t("div",{class:"stat-icon stat-posts"},[t("i",{class:"icon-document"})],-1)),t("div",Gt,[t("div",Qt,l(n(E)(f.posts)),1),s[5]||(s[5]=t("div",{class:"stat-label"},"总帖子",-1))])]),t("div",Wt,[s[8]||(s[8]=t("div",{class:"stat-icon stat-users"},[t("i",{class:"icon-users"})],-1)),t("div",jt,[t("div",$t,l(n(E)(f.users)),1),s[7]||(s[7]=t("div",{class:"stat-label"},"注册用户",-1))])]),t("div",Jt,[s[10]||(s[10]=t("div",{class:"stat-icon stat-solutions"},[t("i",{class:"icon-check-circle"})],-1)),t("div",Yt,[t("div",Zt,l(n(E)(f.solutions)),1),s[9]||(s[9]=t("div",{class:"stat-label"},"解决方案",-1))])])])]),t("div",ts,[t("div",ss,[t("section",es,[t("div",as,[s[14]||(s[14]=t("h2",{class:"section-title"},[t("span",{class:"material-icons-round"},"local_fire_department"),m(" 热门讨论 ")],-1)),t("div",os,[d(Pt,{modelValue:F.value,"onUpdate:modelValue":s[2]||(s[2]=e=>F.value=e),size:"small",class:"time-filter"},{default:p(()=>[d(O,{value:"day"},{default:p(()=>s[11]||(s[11]=[m("今日")])),_:1,__:[11]}),d(O,{value:"week"},{default:p(()=>s[12]||(s[12]=[m("本周")])),_:1,__:[12]}),d(O,{value:"month"},{default:p(()=>s[13]||(s[13]=[m("本月")])),_:1,__:[13]})]),_:1},8,["modelValue"])])]),h.value?(a(),i("div",ns,[d(P,{rows:3,animated:"",class:"skeleton-card"}),d(P,{rows:3,animated:"",class:"skeleton-card"})])):c.value&&c.value.length===0?(a(),i("div",ls,[d(R,{description:"暂无帖子"})])):(a(),i("div",is,[(a(!0),i(z,null,X(c.value,e=>(a(),b(Lt,{key:e.id,post:e,class:"animated-post-card"},null,8,["post"]))),128)),c.value&&c.value.length>0?(a(),i("div",cs,[d(r,{type:"primary",loading:D.value,disabled:v.currentPage>=v.totalPages,onClick:kt,class:"load-more-btn"},{default:p(()=>[m(l(v.currentPage>=v.totalPages?"已加载全部":"加载更多"),1)]),_:1},8,["loading","disabled"])])):V("",!0)]))]),t("section",rs,[s[17]||(s[17]=t("div",{class:"section-header"},[t("h2",{class:"section-title"},[t("span",{class:"material-icons-round"},"star"),m(" 推荐阅读 ")]),t("div",{class:"section-actions"},[t("a",{href:"#",class:"view-all-link"},[m(" 更多推荐 "),t("span",{class:"material-icons-round"},"chevron_right")])])],-1)),I.value?(a(),i("div",ds,[d(P,{rows:3,animated:"",class:"skeleton-card"}),d(P,{rows:3,animated:"",class:"skeleton-card"})])):T.value&&T.value.length===0?(a(),i("div",us,[d(R,{description:"暂无推荐内容"})])):(a(),i("div",_s,[u.value&&u.value.length>0?(a(),i("div",ms,[t("div",vs,[t("div",ps,[t("img",{src:((W=u.value[0])==null?void 0:W.image)||"../assets/default-avatar.png",alt:(j=u.value[0])==null?void 0:j.title},null,8,fs)]),t("div",hs,[t("div",gs,l((J=($=u.value[0])==null?void 0:$.category)==null?void 0:J.name),1),t("h3",ys,l((Y=u.value[0])==null?void 0:Y.title),1),t("p",ks,l(n(dt)((Z=u.value[0])==null?void 0:Z.content,120)),1),t("div",Cs,[t("div",Ps,[t("img",{src:n(At)((tt=u.value[0])==null?void 0:tt.user),alt:n(q)((st=u.value[0])==null?void 0:st.user),class:"author-avatar"},null,8,ws),t("span",bs,l(n(q)((et=u.value[0])==null?void 0:et.user)),1)]),t("div",Ts,l(n(ut)(((at=u.value[0])==null?void 0:at.createdAt)||((ot=u.value[0])==null?void 0:ot.created_at))),1)]),n(G)(u.value[0])?(a(),b(x,{key:0,to:{name:"postDetail",params:{id:u.value[0].id}},class:"read-more-link"},{default:p(()=>s[15]||(s[15]=[m(" 阅读全文 "),t("i",{class:"icon-arrow-right"},null,-1)])),_:1,__:[15]},8,["to"])):V("",!0)])])])):V("",!0),u.value&&u.value.length>1?(a(),i("div",Ns,[(a(!0),i(z,null,X(u.value.slice(1,4),e=>{var S;return a(),i("div",{key:e.id,class:"featured-card side-feature"},[t("div",xs,[t("div",Ss,l((S=e.category)==null?void 0:S.name),1),t("h4",Vs,l(e.title),1),t("div",Es,[t("span",Ls,l(n(q)(e.user)),1),t("span",As,l(n(ut)(e.createdAt||e.created_at)),1)]),n(G)(e)?(a(),b(x,{key:0,to:{name:"postDetail",params:{id:e.id}},class:"read-more-link small"},{default:p(()=>s[16]||(s[16]=[m(" 阅读全文 ")])),_:2,__:[16]},1032,["to"])):V("",!0)]),t("div",Ms,[t("img",{src:e.image||"../assets/default-avatar.png",alt:e.title},null,8,Us)])])}),128))])):V("",!0)]))]),t("section",Ds,[t("div",Fs,[s[19]||(s[19]=t("h2",{class:"section-title"},[t("span",{class:"material-icons-round"},"lightbulb"),m(" 生活技巧 ")],-1)),t("div",Is,[d(x,{to:"/category/2",class:"view-all-link"},{default:p(()=>s[18]||(s[18]=[m(" 查看更多 "),t("span",{class:"material-icons-round"},"chevron_right",-1)])),_:1,__:[18]})])]),B.value?(a(),i("div",Bs,[d(P,{rows:3,animated:"",class:"skeleton-card"}),d(P,{rows:3,animated:"",class:"skeleton-card"})])):N.value&&N.value.length===0?(a(),i("div",Hs,[d(R,{description:"暂无生活技巧内容"})])):(a(),i("div",Ks,[(a(!0),i(z,null,X(vt.value,e=>{var S;return a(),i("div",{key:e.id,class:"life-tip-card card"},[t("div",Os,[t("img",{src:e.image||"../assets/default-avatar.png",alt:e.title,class:"tip-image"},null,8,Rs)]),t("div",zs,[n(G)(e)?(a(),b(x,{key:0,to:{name:"postDetail",params:{id:e.id}},class:"tip-title-link"},{default:p(()=>[t("h3",Xs,l(e.title),1)]),_:2},1032,["to"])):(a(),i("h3",qs,l(e.title),1)),t("p",Gs,l(n(dt)(e.content,n(It).COMMENT_PREVIEW_LENGTH)),1),t("div",Qs,[t("div",Ws,[(S=e.user)!=null&&S.id?(a(),b(x,{key:0,to:{name:"userProfile",params:{id:e.user.id}},class:"author-link"},{default:p(()=>{var nt,lt,it;return[t("img",{src:n(_t)((nt=e.user)==null?void 0:nt.avatar),alt:((lt=e.user)==null?void 0:lt.username)||"用户",class:"avatar avatar--small"},null,8,js),t("span",$s,l((it=e.user)==null?void 0:it.username),1)]}),_:2},1032,["to"])):(a(),i("div",Js,[t("img",{src:n(_t)(),alt:"用户",class:"avatar avatar--small"},null,8,Ys),t("span",Zs,l(n(Bt).UNKNOWN_USER),1)]))]),t("div",te,[t("span",se,[s[20]||(s[20]=t("span",{class:"material-icons-round"},"visibility",-1)),m(l(n(E)(e.view_count)),1)]),t("span",ee,[s[21]||(s[21]=t("span",{class:"material-icons-round"},"comment",-1)),m(l(n(E)(e.comment_count)),1)])])])])])}),128))]))])]),t("div",ae,[d(Ft)])])])]}),_:1})}}}),ve=Et(oe,[["__scopeId","data-v-4c9374b5"]]);export{ve as default};
